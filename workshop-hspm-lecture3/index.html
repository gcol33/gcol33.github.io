<!doctype html><html><head>  <meta charset="utf-8">  <meta name="keywords" content="">  <meta name="description" content="">  <meta name="viewport" content="width=device-width, initial-scale=1.0, viewport-fit=cover"><meta name="robots" content="index, follow">  <link rel="shortcut icon" type="image/svg" href="../favicon.svg">  <link rel="stylesheet" type="text/css" href="../css/bootstrap.min.css?2559"><link rel="stylesheet" type="text/css" href="../style.css?2160"><link rel="stylesheet" type="text/css" href="../css/animate.min.css?1714"><link rel="stylesheet" type="text/css" href="../css/all.min.css"><link rel="stylesheet" type="text/css" href="../css/ionicons.min.css">  <title>Workshop-HSPM-Lecture1-1-1</title>  <!-- Analytics --> <!-- Analytics END -->  </head><body data-clean-url="true"><!-- Preloader --><div id="page-loading-blocs-notifaction" class="page-preloader"></div><!-- Preloader END --><!-- Main container --><div class="page-container">  <!-- navbar --><div class="bloc l-bloc " id="navbar"><div class="container bloc-sm"><div class="row"><div class="order-md-0 offset-sm-0 text-start align-self-center text-sm-start offset-0 col-lg-9 navs-controls col-md-9 col-12 order-1 col-sm-9 order-sm-0"><nav class="navbar navbar-light row navbar-expand-md" role="navigation"><div class="container-fluid"><a class="navbar-brand animated pulse-hvr" href="../" target="_blank"><picture><source type="image/webp" srcset="../img/bioinvasion_logo_500x500_BW.webp"><img src="../img/bioinvasion_logo_500x500_BW.png" alt="logo" class="me-2" width="36" height="36"></picture>Researcher</a></div></nav><nav class="navbar navbar-light row navbar-expand-md pt-0 pb-0 nav-invert hover-open-submenu"><div class="container-fluid nav-invert"><button id="nav-toggle" type="button" class="ui-navbar-toggler navbar-toggler border-0 p-0" aria-expanded="false" aria-label="Toggle navigation" data-bs-toggle="collapse" data-bs-target=".navbar-17897"><span class="navbar-toggler-icon"><svg height="32" viewBox="0 0 32 32" width="32"><path class="svg-menu-icon  " d="m2 9h28m-28 7h28m-28 7h28"></path></svg></span></button><div class="collapse navbar-collapse navbar-19859 navbar-17897  sidebar-nav"><ul class="site-navigation nav navbar-nav"><li class="nav-item"><div class="dropdown btn-dropdown dropdown"><a href="#" class="nav-link nav-links dropdown-toggle" data-bs-toggle="dropdown" aria-expanded="false" tabindex="0">Research</a><ul class="dropdown-menu" role="menu"><li class="nav-item"><a href="../publications/" class="nav-link nav-list-links">Publications</a></li><li class="nav-item"><a href="../presentations/" class="nav-link nav-list-links">Presentations</a><div class="devmargin"><div class="divider-h nav-divider-0"></div></div></li><li class="nav-item"><a href="../research-archive/" class="nav-link nav-list-links">All Posts</a></li></ul></div></li><li class="nav-item"><div class="dropdown btn-dropdown dropdown"><a href="#" class="nav-link nav-links dropdown-toggle" data-bs-toggle="dropdown" aria-expanded="false" tabindex="0">Engagement</a><ul class="dropdown-menu" role="menu"><li class="nav-item"><a href="../education/" class="nav-link nav-list-links">Education</a></li><li class="nav-item"><a href="../side-projects/" class="nav-link nav-list-links">Side Projects</a></li><li class="nav-item"><div class="devmargin"><div class="divider-h nav-divider-0"></div></div></li><li class="nav-item"><a href="../engagement-archive/" class="nav-link nav-list-links">All Posts</a></li></ul></div></li><li class="nav-item"><div class="dropdown btn-dropdown dropdown"><a href="#" class="nav-link nav-links dropdown-toggle" data-bs-toggle="dropdown" aria-expanded="false" tabindex="0">Projects</a><ul class="dropdown-menu" role="menu"><li class="nav-item"><a href="../projasaas/" class="nav-link nav-list-links">ASAAS</a></li><li class="nav-item"><a href="../projagriweed/" class="nav-link nav-list-links">AgriWeedClim</a></li></ul></div></li><li class="nav-item"><a href="https://www.gillescolling.com/blog" class="nav-link nav-links link-about-style">Blog</a></li><li class="nav-item"><a href="../contact/" class="nav-link nav-links link-about-style">Contact</a></li><li class="nav-item"><a href="../author/" class="nav-link nav-links link-about-style">About</a></li></ul></div></div></nav></div><div class="col-lg-3 col-md-3 text-start order-sm-0 col-12 order-0 nav-icon-background align-self-center mb-md-1 mb-lg-1 mt-sm-0 mt-0 col-sm-3"><div><div class="social-link-bric"><a href="https://twitter.com/Gilles__Colling" class="twitter-link" target="_blank"><svg xmlns="http://www.w3.org/2000/svg" width="46" height="46" fill="#212121" viewBox="0 0 24 24" style="margin-left: 4px; margin-right: 4px;"><path d="m19 24h-14a5 5 0 0 1 -5-5v-14a5 5 0 0 1 5-5h14a5 5 0 0 1 5 5v14a5 5 0 0 1 -5 5zm.053-18.993h-2.453l-4.047 4.468-3.493-4.468h-5.06l6.047 7.646-5.734 6.337h2.454l4.426-4.89 3.867 4.89h4.94l-6.307-8.059zm-3.313 12.565-8.873-11.218h1.46l8.773 11.218z"></path></svg></a><a href="https://linkedin.com/in/gilles-colling-0b3747306/ " class="linkedin-link" target="_blank"><svg xmlns="http://www.w3.org/2000/svg" width="46" height="46" fill="#212121" viewBox="0 0 24 24" style="margin-left: 4px; margin-right: 4px;"><path d="M19 0h-14c-2.761 0-5 2.239-5 5v14c0 2.761 2.239 5 5 5h14c2.762 0 5-2.239 5-5v-14c0-2.761-2.238-5-5-5zm-11 19h-3v-11h3v11zm-1.5-12.268c-.966 0-1.75-.79-1.75-1.764s.784-1.764 1.75-1.764 1.75.79 1.75 1.764-.783 1.764-1.75 1.764zm13.5 12.268h-3v-5.604c0-3.368-4-3.113-4 0v5.604h-3v-11h3v1.765c1.396-2.586 7-2.777 7 2.476v6.759z"></path></svg></a><a href="https://bsky.app/profile/gilles-colling.bsky.social" class="bluesky-link" target="_blank"><svg xmlns="http://www.w3.org/2000/svg" fill="#212121" width="46" height="46" viewBox="0 0 24 24" style="margin-left: 4px; margin-right: 4px;"><path d="m19,24H5c-2.76,0-5-2.24-5-5V5C0,2.24,2.24,0,5,0h14c2.76,0,5,2.24,5,5v14c0,2.76-2.24,5-5,5Zm-2.08-18.61c-1.99,1.49-4.12,4.51-4.91,6.14-.79-1.62-2.92-4.64-4.91-6.14-1.43-1.08-3.75-1.91-3.77.74,0,.53.3,4.45.48,5.08.62,2.21,2.87,2.77,4.88,2.43-3.5.6-4.4,2.57-2.47,4.55,3.66,3.75,5.26-.94,5.67-2.14.07-.22.11-.32.11-.24,0-.09.04.01.11.24.41,1.21,2.01,5.9,5.67,2.14,1.93-1.98,1.03-3.95-2.47-4.55,2.01.34,4.26-.22,4.88-2.43.18-.64.48-4.56.48-5.08,0-2.65-2.32-1.82-3.75-.74Z"></path></svg></a><a href="https://www.researchgate.net/profile/Gilles-Colling" class="researchgate-link" target="_blank"><svg fill="#212121" width="46" height="46" viewBox="0 0 24 24" xmlns="http://www.w3.org/2000/svg" style="margin-left: 4px; margin-right: 4px;"><path d="M 5 0 C 2.2400028 0 0 2.2400028 0 5 L 0 19 C 0 21.759997 2.2400028 24 5 24 L 19 24 C 21.759997 24 24 21.759997 24 19 L 24 5 C 24 2.2400028 21.759997 0 19 0 L 5 0 z M 17.689453 3 A 3.051 3.051 0 0 1 18.546875 3.1113281 A 2.48475 2.48475 0 0 1 19.222656 3.4179688 A 2.25 2.25 0 0 1 19.732422 3.8730469 A 2.66175 2.66175 0 0 1 20.082031 4.4296875 C 20.118031 4.4926874 20.107031 4.5440782 20.050781 4.5800781 L 19.267578 4.9023438 C 19.202328 4.9383437 19.154391 4.9201093 19.119141 4.8496094 C 18.942141 4.5248597 18.794375 4.3114998 18.546875 4.15625 C 18.300125 4.0010002 18.0685 3.9277344 17.6875 3.9277344 C 17.2795 3.9277344 17.093937 4.0103596 16.835938 4.1933594 A 1.4175 1.4175 0 0 0 16.279297 4.9492188 A 2.3925 2.3925 0 0 0 16.167969 5.5195312 A 11.86575 11.8665 0 0 0 16.140625 6.0117188 A 19.80075 19.80225 0 0 0 16.130859 6.7148438 C 16.130859 6.9900935 16.133125 7.2249221 16.140625 7.4199219 A 13.0245 13.02525 0 0 0 16.167969 7.9121094 A 2.352 2.352 0 0 0 16.277344 8.4824219 C 16.392094 8.8281715 16.549797 9.017672 16.779297 9.1699219 C 17.011047 9.3221717 17.27875 9.4335938 17.6875 9.4335938 C 18.05425 9.4335938 18.389922 9.3308748 18.607422 9.171875 C 18.824922 9.0128752 19.004938 8.8043747 19.085938 8.515625 C 19.121187 8.3963751 19.166813 8.2435467 19.195312 8.0605469 C 19.222312 7.8767971 19.222656 7.6821091 19.222656 7.4121094 C 19.222656 7.3701094 19.202156 7.3476562 19.160156 7.3476562 L 17.910156 7.3476562 C 17.839656 7.3476563 17.806641 7.3126874 17.806641 7.2421875 L 17.806641 6.5253906 C 17.806641 6.4548907 17.839656 6.4199219 17.910156 6.4199219 L 20.208984 6.4199219 C 20.278734 6.4199219 20.314453 6.4541407 20.314453 6.5253906 L 20.314453 7.140625 A 8.175 8.175 0 0 1 20.28125 8.046875 C 20.24975 8.3258747 20.205437 8.5678908 20.148438 8.7441406 C 19.972188 9.2946401 19.695078 9.687969 19.267578 9.9804688 C 18.840829 10.272968 18.289453 10.433594 17.689453 10.433594 C 17.075204 10.433594 16.556562 10.291765 16.132812 10.009766 C 15.709813 9.7270159 15.406406 9.3072494 15.222656 8.75 A 2.5005 2.5005 0 0 1 15.136719 8.421875 L 15.140625 8.421875 A 5.9595 5.9595 0 0 1 15.083984 8.0234375 A 6.75 6.75 0 0 1 15.044922 7.4785156 A 23.34075 23.34225 0 0 1 15.035156 6.7167969 C 15.035156 6.4205472 15.037422 6.1665779 15.044922 5.9550781 A 6.75 6.75 0 0 1 15.082031 5.4082031 A 6.27375 6.27375 0 0 1 15.140625 5.0117188 A 2.39475 2.39475 0 0 1 15.224609 4.6835938 C 15.406859 4.1255943 15.712516 3.7065778 16.134766 3.4238281 C 16.558515 3.1425784 17.075954 3 17.689453 3 z M 9.1621094 7.3769531 L 9.1640625 7.3769531 C 11.61356 7.3769531 13.482422 8.494393 13.482422 10.900391 C 13.482422 12.533889 12.19117 14.167422 10.451172 14.576172 C 11.504921 16.44517 12.773751 18.09886 13.71875 19.130859 C 14.277499 19.732359 15.05097 20.269531 15.824219 20.269531 L 15.824219 20.828125 C 15.587969 20.936125 15.201187 21 14.835938 21 C 13.589439 21 12.602031 20.506421 11.957031 19.732422 C 11.248282 18.916423 10.000452 17.154748 8.6894531 14.8125 C 8.0024538 14.8125 7.5511557 14.812281 7.0351562 14.769531 L 7.0351562 18.357422 C 7.0351563 19.690171 7.3362662 19.968438 7.9160156 20.054688 L 9.0332031 20.205078 L 9.0332031 20.828125 C 8.4962037 20.806375 7.2507022 20.763672 6.2832031 20.763672 C 5.2744541 20.763672 4.2652963 20.806375 3.6855469 20.828125 L 3.6855469 20.205078 L 4.5 20.054688 C 5.0579994 19.947438 5.3808594 19.690171 5.3808594 18.357422 L 5.3808594 9.890625 C 5.3808594 8.5586263 5.0579994 8.3013593 4.5 8.1933594 L 3.6855469 8.0429688 L 3.6855469 7.4199219 C 4.2225463 7.4416719 5.079954 7.4414062 5.9394531 7.4414062 C 6.8852022 7.4414062 7.8946106 7.3769531 9.1621094 7.3769531 z M 8.7753906 8.34375 C 8.1956412 8.34375 7.5301558 8.3444219 7.0351562 8.3886719 L 7.0351562 13.78125 C 7.5294058 13.82325 7.851532 13.845703 8.5820312 13.845703 C 10.494529 13.845703 11.65625 12.705061 11.65625 11.007812 C 11.65625 9.2888142 10.581842 8.34375 8.7773438 8.34375 L 8.7753906 8.34375 z"></path></svg></a></div></div></div></div></div></div><!-- navbar END --><!-- bloc-32 --><div class="bloc l-bloc" id="bloc-32"><div class="container bloc-lg bloc-sm-lg"><div class="row"><div class="col text-start"><div class="dev-nav-link mb-2"><a href="../" class="a-btn text-link-01">Home</a><span class="ion ion-chevron-right arrow-arrow"></span><a href="../" class="a-btn text-link-01">Engagement</a><span class="ion ion-chevron-right arrow-arrow"></span><a href="../publications/" class="a-btn text-link-01">Workshops</a><span class="ion ion-chevron-right arrow-arrow"></span><a href="../course-spattempdyn/" class="a-btn text-link-01">Hierarchical spatial modelling</a></div><h1 class="mb-4 text-lg-center mt-lg-4">Lecture 3 –&nbsp;Modelling Big Spatial Data</h1><p>In this lecture, Jeffrey Doser addressed a growing challenge in modern spatial ecology: How to efficiently fit models when the dataset includes hundreds or even thousands of spatial locations. While Gaussian processes (GPs) are the gold standard for modeling spatial autocorrelation, they become computationally prohibitive as the number of locations increases. This session introduced the so-called big \( n \) problem and focused on how recent innovations like Nearest Neighbor Gaussian Processes (NNGPs) provide scalable solutions.<br><br>We began by revisiting the Bayesian spatial linear model, where a spatial random effect \( w \) is assigned a Gaussian process prior. The spatial structure is captured by a covariance matrix \( \mathbf{C} \), which is of dimension \( J \times J \), with \( J \) being the number of spatial locations. The values in \( \mathbf{C} \) are dense, meaning no entries are zero, and are computed based on pairwise distances between locations. While this is feasible when \( J \) is small, things get difficult very quickly.<br><br>For example, when \( J = 5 \), the covariance matrix is small and easy to store and invert. But for \( J = 1{,}000 \), the storage requirement is on the order of \( O(J^2) \), and the number of floating-point operations needed to invert the matrix jumps to \( O(J^3) \). For a modest dataset of 1,600 spatial locations, fitting a full GP already becomes extremely slow. This is the essence of the big \( n \) problem.<br><br>To understand what’s going on under the hood, we looked at how the GP model requires computing multivariate normal likelihoods, inverting large dense matrices, and storing huge distance matrices. This creates both memory and time constraints, which limit the practical use of GPs for large-scale spatial modeling in ecology and conservation.<br><br>The lecture then turned to potential solutions. Three broad categories were introduced:<br></p><ol><li><p><i>Low-rank methods</i>, which reduce the dimensionality of the spatial surface, much like how principal component analysis reduces dimensionality in multivariate data. These methods approximate the full covariance structure using a smaller set of basis functions.<br></p></li><li><p><i>Sparse methods</i>, which modify the covariance or precision matrix to include many zeros. This sparsity drastically reduces the computational burden because operations like matrix inversion become much faster when most entries are zero.<br></p></li><li><p><i>Algorithmic methods</i>, which focus on rethinking the computational workflow without changing the underlying model structure. These might involve clever matrix decomposition techniques, approximation schemes, or parallel processing.</p></li></ol><p>Among these, the lecture focused in detail on Nearest Neighbor Gaussian Processes (NNGPs), introduced by <a class="text-link-01" href="https://pubmed.ncbi.nlm.nih.gov/29720777/">Datta et al. (2016)</a> and further developed by <a class="text-link-01" href="https://pmc.ncbi.nlm.nih.gov/articles/PMC6753955/">Finley et al. (2019)</a>. NNGPs offer a sparse and scalable approximation to full GPs, while retaining the same model structure and interpretation. That is, NNGPs have the same spatial parameters as GPs and generate similar spatial surfaces, but can be applied to much larger datasets.<br><br>The conceptual foundation of NNGPs is surprisingly intuitive. First, spatial locations are ordered, often just along the x-axis. Then, for each location, we define a set of its \( m \) nearest neighbors (subject to the ordering). The key idea is that the spatial random effect at each location is assumed to depend only on the values of these neighbors. This assumption introduces <i>conditional independence</i>, which is the heart of what makes the approach computationally efficient.<br><br>Instead of a dense \( J \times J \) covariance matrix, NNGPs produce a sparse matrix. Each entry depends only on a small set of nearby locations. As a result, the storage requirement drops to \( O(Jm^2) \), and computation scales as \( O(Jm^3) \). Because \( m \ll J \), the savings are substantial. And unlike low-rank methods, NNGPs preserve local variation and perform well in capturing short-range spatial structure.<br><br>In practical terms, the `spOccupancy` and `spAbundance` R packages implement NNGPs by ordering sites along the Easting coordinate and using default neighbor sizes like \( m = 15 \). Users can adjust this value and compare different options using criteria like the Widely Applicable Information Criterion (WAIC). Even relatively small neighbor sets tend to perform well, and increasing \( m \) improves accuracy at the cost of computation.<br><br>We then looked at how NNGPs are built. Mathematically, they rely on rewriting the Gaussian process as a product of conditional densities. Graphical models are used to impose the neighbor structure, introducing sparsity in a principled way. At the end, the only change to the standard GP model is replacing the dense covariance matrix \( \mathbf{C} \) with a sparse NNGP-derived version. The rest of the modeling workflow, prior specification, likelihood structure, MCMC fitting, remains the same.<br><br>An example was presented with a simulated dataset of 1,600 locations. A full GP took significantly longer to fit, while the NNGP version completed in a fraction of the time with nearly identical results. This demonstrated that NNGPs are not just a theoretical solution: They are practical and effective in real-world modeling.<br><br>The key insight from this session was that modern spatial modeling must address computational scale, and methods like NNGPs allow us to do so without sacrificing the core strengths of Gaussian processes. For ecologists working with large datasets, e.g., broad-scale surveys, satellite-derived environmental layers, or automated detection systems: These techniques unlock possibilities that were previously out of reach.<br></p></div></div></div></div><!-- bloc-32 END --><!-- bloc-96 --><div class="bloc l-bloc" id="bloc-96"><div class="container bloc-lg bloc-sm-lg"><div class="row"><div class="col-md-6 text-start text-lg-start"><a href="../workshop-hspm-lecture2/" class="btn btn-d btn-lg">Lecture 2</a></div><div class="col-md-6 text-start text-lg-end"><a href="../workshop-hspm-lecture4/" class="btn btn-d btn-lg">Lecture 4<br></a></div></div></div></div><!-- bloc-96 END --><!-- ScrollToTop Button --><button aria-label="Scroll to top button" class="bloc-button btn btn-d scrollToTop" onclick="scrollToTarget('1',this)"><svg xmlns="http://www.w3.org/2000/svg" width="22" height="22" viewBox="0 0 32 32"><path class="scroll-to-top-btn-icon" d="M30,22.656l-14-13-14,13"/></svg></button><!-- ScrollToTop Button END--><!-- pencil-footer --><div class="bloc l-bloc" id="pencil-footer"><div class="container bloc-sm bloc-sm-lg"><div class="row"><div class="col-md-6 text-start order-1 order-md-0"><p class="mb-0 footer-brand">© Copyright - Gilles Colling</p></div><div class="col-md-6 text-start footer-right mb-md-0 mb-sm-3 mb-3"><a href="../contact/" class="a-btn text-link-01 p-md">Contact</a></div></div></div></div><!-- pencil-footer END --></div><!-- Main container END -->  <!-- Additional JS --><script src="../js/bootstrap.bundle.min.js?6371"></script><script src="../js/blocs.min.js?3324"></script><script src="../js/lazysizes.min.js" defer></script><!-- Additional JS END --><!-- KaTeX CSS --><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/KaTeX/0.16.4/katex.min.css"><!-- KaTeX JS --><script defer src="https://cdnjs.cloudflare.com/ajax/libs/KaTeX/0.16.4/katex.min.js"></script><!-- Auto-rendering --><script defer src="https://cdnjs.cloudflare.com/ajax/libs/KaTeX/0.16.4/contrib/auto-render.min.js"  onload="renderMathInElement(document.body);"></script></body></html>