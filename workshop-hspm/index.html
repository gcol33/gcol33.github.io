<!doctype html><html><head>  <meta charset="utf-8">  <meta name="keywords" content="">  <meta name="description" content="">  <meta name="viewport" content="width=device-width, initial-scale=1.0, viewport-fit=cover"><meta name="robots" content="index, follow">  <link rel="shortcut icon" type="image/svg" href="../favicon.svg">  <link rel="stylesheet" type="text/css" href="../css/bootstrap.min.css?2107"><link rel="stylesheet" type="text/css" href="../style.css?9491"><link rel="stylesheet" type="text/css" href="../css/animate.min.css?1307"><link rel="stylesheet" type="text/css" href="../css/all.min.css"><link rel="stylesheet" type="text/css" href="../css/ionicons.min.css">  <title>Workshop - HSPM</title>  <!-- Analytics --> <!-- Analytics END -->  </head><body data-clean-url="true"><!-- Preloader --><div id="page-loading-blocs-notifaction" class="page-preloader"></div><!-- Preloader END --><!-- Main container --><div class="page-container">  <!-- navbar --><div class="bloc l-bloc" id="navbar"><div class="container bloc-no-padding-lg bloc-no-padding-md bloc-no-padding-sm bloc-no-padding"><div class="row"><div class="order-md-0 offset-sm-0 text-start align-self-center text-sm-start offset-0 col-lg-9 navs-controls col-md-9 col-12 order-1 col-sm-9 order-sm-0"><nav class="navbar navbar-light row navbar-expand-md" role="navigation"><div class="container-fluid"><a class="navbar-brand animated pulse-hvr" href="../" target="_blank"><picture><source type="image/webp" srcset="../img/bioinvasion_logo_500x500_BW.webp"><img src="../img/bioinvasion_logo_500x500_BW.png" alt="logo" class="me-2" width="36" height="36"></picture>Researcher</a></div></nav><nav class="navbar navbar-light row navbar-expand-md pt-0 pb-0 nav-invert hover-open-submenu"><div class="container-fluid nav-invert"><button id="nav-toggle" type="button" class="ui-navbar-toggler navbar-toggler border-0 p-0" aria-expanded="false" aria-label="Toggle navigation" data-bs-toggle="collapse" data-bs-target=".navbar-17897"><span class="navbar-toggler-icon"><svg height="32" viewBox="0 0 32 32" width="32"><path class="svg-menu-icon  " d="m2 9h28m-28 7h28m-28 7h28"></path></svg></span></button><div class="collapse navbar-collapse navbar-19859 navbar-17897  sidebar-nav"><ul class="site-navigation nav navbar-nav"><li class="nav-item"><div class="dropdown btn-dropdown dropdown"><a href="#" class="nav-link nav-links dropdown-toggle" data-bs-toggle="dropdown" aria-expanded="false" tabindex="0">Research</a><ul class="dropdown-menu" role="menu"><li class="nav-item"><a href="../publications/" class="nav-link nav-list-links">Publications</a></li><li class="nav-item"><a href="../presentations/" class="nav-link nav-list-links">Presentations</a><div class="devmargin"><div class="divider-h nav-divider-0"></div></div></li><li class="nav-item"><a href="../research-archive/" class="nav-link nav-list-links">All Posts</a></li></ul></div></li><li class="nav-item"><div class="dropdown btn-dropdown dropdown"><a href="#" class="nav-link nav-links dropdown-toggle" data-bs-toggle="dropdown" aria-expanded="false" tabindex="0">Engagement</a><ul class="dropdown-menu" role="menu"><li class="nav-item"><a href="../education/" class="nav-link nav-list-links">Education</a></li><li class="nav-item"><a href="../side-projects/" class="nav-link nav-list-links">Side Projects</a></li><li class="nav-item"><div class="devmargin"><div class="divider-h nav-divider-0"></div></div></li><li class="nav-item"><a href="../engagement-archive/" class="nav-link nav-list-links">All Posts</a></li></ul></div></li><li class="nav-item"><div class="dropdown btn-dropdown dropdown"><a href="#" class="nav-link nav-links dropdown-toggle" data-bs-toggle="dropdown" aria-expanded="false" tabindex="0">Projects</a><ul class="dropdown-menu" role="menu"><li class="nav-item"><a href="../projasaas/" class="nav-link nav-list-links">ASAAS</a></li><li class="nav-item"><a href="../projagriweed/" class="nav-link nav-list-links">AgriWeedClim</a></li></ul></div></li><li class="nav-item"><a href="https://www.gillescolling.com/blog" class="nav-link nav-links link-about-style">Blog</a></li><li class="nav-item"><a href="../contact/" class="nav-link nav-links link-about-style">Contact</a></li><li class="nav-item"><a href="../author/" class="nav-link nav-links link-about-style">About</a></li></ul></div></div></nav></div><div class="col-lg-3 col-md-3 text-start order-sm-0 col-12 order-0 nav-icon-background align-self-center mb-md-1 mb-lg-1 mt-sm-0 mt-0 col-sm-3"><div><div class="social-link-bric" data-aria="true"><a href="https://twitter.com/Gilles__Colling" class="twitter-link" target="_blank" aria-label="Twitter"><svg xmlns="http://www.w3.org/2000/svg" width="46" height="46" fill="#212121" viewBox="0 0 24 24" style="margin-left: 4px; margin-right: 4px;"><path d="m19 24h-14a5 5 0 0 1 -5-5v-14a5 5 0 0 1 5-5h14a5 5 0 0 1 5 5v14a5 5 0 0 1 -5 5zm.053-18.993h-2.453l-4.047 4.468-3.493-4.468h-5.06l6.047 7.646-5.734 6.337h2.454l4.426-4.89 3.867 4.89h4.94l-6.307-8.059zm-3.313 12.565-8.873-11.218h1.46l8.773 11.218z"></path></svg></a><a href="https://linkedin.com/in/gilles-colling-0b3747306/ " class="linkedin-link" target="_blank" aria-label="LinkedIn"><svg xmlns="http://www.w3.org/2000/svg" width="46" height="46" fill="#212121" viewBox="0 0 24 24" style="margin-left: 4px; margin-right: 4px;"><path d="M19 0h-14c-2.761 0-5 2.239-5 5v14c0 2.761 2.239 5 5 5h14c2.762 0 5-2.239 5-5v-14c0-2.761-2.238-5-5-5zm-11 19h-3v-11h3v11zm-1.5-12.268c-.966 0-1.75-.79-1.75-1.764s.784-1.764 1.75-1.764 1.75.79 1.75 1.764-.783 1.764-1.75 1.764zm13.5 12.268h-3v-5.604c0-3.368-4-3.113-4 0v5.604h-3v-11h3v1.765c1.396-2.586 7-2.777 7 2.476v6.759z"></path></svg></a><a href="https://bsky.app/profile/gilles-colling.bsky.social" class="bluesky-link" target="_blank" aria-label="Bluesky"><svg xmlns="http://www.w3.org/2000/svg" fill="#212121" width="46" height="46" viewBox="0 0 24 24" style="margin-left: 4px; margin-right: 4px;"><path d="m19,24H5c-2.76,0-5-2.24-5-5V5C0,2.24,2.24,0,5,0h14c2.76,0,5,2.24,5,5v14c0,2.76-2.24,5-5,5Zm-2.08-18.61c-1.99,1.49-4.12,4.51-4.91,6.14-.79-1.62-2.92-4.64-4.91-6.14-1.43-1.08-3.75-1.91-3.77.74,0,.53.3,4.45.48,5.08.62,2.21,2.87,2.77,4.88,2.43-3.5.6-4.4,2.57-2.47,4.55,3.66,3.75,5.26-.94,5.67-2.14.07-.22.11-.32.11-.24,0-.09.04.01.11.24.41,1.21,2.01,5.9,5.67,2.14,1.93-1.98,1.03-3.95-2.47-4.55,2.01.34,4.26-.22,4.88-2.43.18-.64.48-4.56.48-5.08,0-2.65-2.32-1.82-3.75-.74Z"></path></svg></a><a href="https://www.researchgate.net/profile/Gilles-Colling" class="researchgate-link" target="_blank"><svg fill="#212121" width="46" height="46" viewBox="0 0 24 24" xmlns="http://www.w3.org/2000/svg" style="margin-left: 4px; margin-right: 4px;"><path d="M 5 0 C 2.2400028 0 0 2.2400028 0 5 L 0 19 C 0 21.759997 2.2400028 24 5 24 L 19 24 C 21.759997 24 24 21.759997 24 19 L 24 5 C 24 2.2400028 21.759997 0 19 0 L 5 0 z M 17.689453 3 A 3.051 3.051 0 0 1 18.546875 3.1113281 A 2.48475 2.48475 0 0 1 19.222656 3.4179688 A 2.25 2.25 0 0 1 19.732422 3.8730469 A 2.66175 2.66175 0 0 1 20.082031 4.4296875 C 20.118031 4.4926874 20.107031 4.5440782 20.050781 4.5800781 L 19.267578 4.9023438 C 19.202328 4.9383437 19.154391 4.9201093 19.119141 4.8496094 C 18.942141 4.5248597 18.794375 4.3114998 18.546875 4.15625 C 18.300125 4.0010002 18.0685 3.9277344 17.6875 3.9277344 C 17.2795 3.9277344 17.093937 4.0103596 16.835938 4.1933594 A 1.4175 1.4175 0 0 0 16.279297 4.9492188 A 2.3925 2.3925 0 0 0 16.167969 5.5195312 A 11.86575 11.8665 0 0 0 16.140625 6.0117188 A 19.80075 19.80225 0 0 0 16.130859 6.7148438 C 16.130859 6.9900935 16.133125 7.2249221 16.140625 7.4199219 A 13.0245 13.02525 0 0 0 16.167969 7.9121094 A 2.352 2.352 0 0 0 16.277344 8.4824219 C 16.392094 8.8281715 16.549797 9.017672 16.779297 9.1699219 C 17.011047 9.3221717 17.27875 9.4335938 17.6875 9.4335938 C 18.05425 9.4335938 18.389922 9.3308748 18.607422 9.171875 C 18.824922 9.0128752 19.004938 8.8043747 19.085938 8.515625 C 19.121187 8.3963751 19.166813 8.2435467 19.195312 8.0605469 C 19.222312 7.8767971 19.222656 7.6821091 19.222656 7.4121094 C 19.222656 7.3701094 19.202156 7.3476562 19.160156 7.3476562 L 17.910156 7.3476562 C 17.839656 7.3476563 17.806641 7.3126874 17.806641 7.2421875 L 17.806641 6.5253906 C 17.806641 6.4548907 17.839656 6.4199219 17.910156 6.4199219 L 20.208984 6.4199219 C 20.278734 6.4199219 20.314453 6.4541407 20.314453 6.5253906 L 20.314453 7.140625 A 8.175 8.175 0 0 1 20.28125 8.046875 C 20.24975 8.3258747 20.205437 8.5678908 20.148438 8.7441406 C 19.972188 9.2946401 19.695078 9.687969 19.267578 9.9804688 C 18.840829 10.272968 18.289453 10.433594 17.689453 10.433594 C 17.075204 10.433594 16.556562 10.291765 16.132812 10.009766 C 15.709813 9.7270159 15.406406 9.3072494 15.222656 8.75 A 2.5005 2.5005 0 0 1 15.136719 8.421875 L 15.140625 8.421875 A 5.9595 5.9595 0 0 1 15.083984 8.0234375 A 6.75 6.75 0 0 1 15.044922 7.4785156 A 23.34075 23.34225 0 0 1 15.035156 6.7167969 C 15.035156 6.4205472 15.037422 6.1665779 15.044922 5.9550781 A 6.75 6.75 0 0 1 15.082031 5.4082031 A 6.27375 6.27375 0 0 1 15.140625 5.0117188 A 2.39475 2.39475 0 0 1 15.224609 4.6835938 C 15.406859 4.1255943 15.712516 3.7065778 16.134766 3.4238281 C 16.558515 3.1425784 17.075954 3 17.689453 3 z M 9.1621094 7.3769531 L 9.1640625 7.3769531 C 11.61356 7.3769531 13.482422 8.494393 13.482422 10.900391 C 13.482422 12.533889 12.19117 14.167422 10.451172 14.576172 C 11.504921 16.44517 12.773751 18.09886 13.71875 19.130859 C 14.277499 19.732359 15.05097 20.269531 15.824219 20.269531 L 15.824219 20.828125 C 15.587969 20.936125 15.201187 21 14.835938 21 C 13.589439 21 12.602031 20.506421 11.957031 19.732422 C 11.248282 18.916423 10.000452 17.154748 8.6894531 14.8125 C 8.0024538 14.8125 7.5511557 14.812281 7.0351562 14.769531 L 7.0351562 18.357422 C 7.0351563 19.690171 7.3362662 19.968438 7.9160156 20.054688 L 9.0332031 20.205078 L 9.0332031 20.828125 C 8.4962037 20.806375 7.2507022 20.763672 6.2832031 20.763672 C 5.2744541 20.763672 4.2652963 20.806375 3.6855469 20.828125 L 3.6855469 20.205078 L 4.5 20.054688 C 5.0579994 19.947438 5.3808594 19.690171 5.3808594 18.357422 L 5.3808594 9.890625 C 5.3808594 8.5586263 5.0579994 8.3013593 4.5 8.1933594 L 3.6855469 8.0429688 L 3.6855469 7.4199219 C 4.2225463 7.4416719 5.079954 7.4414062 5.9394531 7.4414062 C 6.8852022 7.4414062 7.8946106 7.3769531 9.1621094 7.3769531 z M 8.7753906 8.34375 C 8.1956412 8.34375 7.5301558 8.3444219 7.0351562 8.3886719 L 7.0351562 13.78125 C 7.5294058 13.82325 7.851532 13.845703 8.5820312 13.845703 C 10.494529 13.845703 11.65625 12.705061 11.65625 11.007812 C 11.65625 9.2888142 10.581842 8.34375 8.7773438 8.34375 L 8.7753906 8.34375 z"></path></svg></a></div></div></div></div></div></div><!-- navbar END --><!-- hero --><div class="bloc l-bloc" id="hero"><div class="container bloc-sm bloc-md-md bloc-sm-lg"><div class="row"><div class="text-start col-md-10 offset-md-1 offset-lg-0 col-lg-12"><div class="dev-nav-link mb-2"><a href="../" class="a-btn text-link-01">Home</a><span class="ion ion-chevron-right arrow-arrow"></span><a href="../" class="a-btn text-link-01">Engagement</a><span class="ion ion-chevron-right arrow-arrow"></span><a href="../education/" class="a-btn text-link-01">Education</a><span class="ion ion-chevron-right arrow-arrow"></span><a href="../course-spattempdyn/" class="a-btn text-link-01">Hierarchical spatial modelling</a></div><h1 class="display-md text-bold text-lg-start mt-lg-4 mb-lg-4">Hierarchical spatial modelling for applied population and community ecology</h1><div class="mt-3 writer-post-group mb-3"><p class="mb-0 p-sm">Jun 24-27, 2024</p><a href="../education/" class="a-btn text-link-01 post-label ">Education</a></div><p>From June 24 to 27, 2024, Jeff Doser and Marc Kéry led a workshop on hierarchical Bayesian spatial models at the Swiss Ornithological Institute in Sempach, Switzerland. Participants brought their own laptops with R, using the `<a class="text-link-01" href="https://doserlab.com/files/spoccupancy-web/">spOccupancy</a>` and `<a class="text-link-01" href="https://doserlab.com/files/spabundance-web/">spAbundance`</a> packages throughout the sessions. While the course didn’t require prior experience with Bayesian or spatial statistics, a solid understanding of regression models in R was expected. All course materials, including lectures and code, were made available via GitHub.<br></p></div></div></div></div><!-- hero END --><!-- hero-img --><div class="bloc bgc-4819 bloc-bg-texture texture-darken-strong bg-hspm-ws-bg d-bloc" id="hero-img"><div class="bloc-shape-divider bloc-divider-bottom"><svg class="svg-divider bloc-divider-b-0-fill" fill-rule="evenodd" preserveAspectRatio="none" viewBox="0 0 1000 250"><path d="M1000,0V250H0v-1Z"></path></svg></div><div class="container bloc-md bloc-lg-md bloc-lg-lg"><div class="row"><div class="col-md-10 offset-md-1 offset-lg-0 col-lg-12"><h2 class="mb-4 display-md tc-4629 text-bold">Course Highlights</h2><div><p class="tc-4629">The course combined theoretical background with hands-on implementation, with about 70 percent of the time dedicated to lectures and the remaining 30 percent to exercises. It began with an overview of hierarchical modelling and spatial statistics, then moved into scalable modelling techniques using `<a class="text-link-02" href="https://doserlab.com/files/spoccupancy-web/">spOccupancy</a>` and `<a class="text-link-02" href="https://doserlab.com/files/spabundance-web/">spAbundance</a>`. Over four packed days, participants worked through topics including single- and multi-species occupancy models, joint species distribution models with imperfect detection, and multi-season models. Later sessions focused on modelling count data using spatial GLMMs, N-mixture models, and hierarchical distance sampling. Real-world applications, such as analyses of Swiss bird data, anchored the exercises in practice. Each day ran from 9:00 to around 17:30, with generous breaks and time set aside for questions and discussion.<br></p></div></div></div></div></div><!-- hero-img END --><!-- bloc-85 --><div class="bloc l-bloc" id="bloc-85"><div class="container bloc-lg"><div class="row"><div class="col text-start"><h1 class="mb-4 text-lg-center mt-lg-4">Introduction to Hierarchical Models for Distribution and Abundance</h1><p>The opening session of the workshop set the foundation of hierarchical modelling by introducing the concept of HMs (hierarchical models) and explaining how they help us answer core ecological questions. These questions include: How many individuals are there? Where are they? How do abundance and distribution vary across space and time? And what environmental or demographic factors drive these patterns?<br><br>At the heart of this framework lies the idea of <i>point patterns</i>. In theory, the most fundamental way to describe a population or community is as a realization of a stochastic point process. A point pattern consists of a set of spatial coordinates, with each point representing an individual organism. This can be modeled using a homogeneous or inhomogeneous point process,, depending on whether intensity (expected density of individuals) varies across space.<br><br>However, real-world data rarely take this ideal form. It’s difficult to record exact locations for every individual, and spatially continuous models require mathematical tools like integrals that biologists often avoid. Moreover, data often come in aggregated formats, counts per site, presence/absence in grid cells, or summaries by administrative region. So instead of modeling point patterns directly, we summarize them into two main quantities:<br></p><ul><li><p>Abundance (N): The number of individuals per site or unit area.<br></p></li><li><p>Distribution (z or ψ): Presence/absence or the probability of occurrence.</p></li></ul><p>The lecture emphasized that distribution is not an independent quantity: It is a <i>deterministic function of abundance</i>. In particular, if abundance follows a Poisson distribution with rate \( \lambda \), then occupancy probability is given by:</p><div>\[\psi = 1 - e^{-\lambda}\]</div><p>This makes distribution a lower-information summary of abundance. It’s useful when abundance data are unavailable or detection is very low, but it cannot reveal much once all sites are saturated (i.e., when \( \psi \to 1 \)).<br><br>The discussion also highlighted the scale dependence of both abundance and distribution. How we discretize space (how large our sampling units are) directly affects the interpretation of results. For instance, small units tend to have low occupancy (since many will contain zero individuals), while very large units may have occupancy close to one. This modifiable area unit problem complicates comparisons across studies and scales.<br><br>Another key theme was measurement error. While point patterns have three types of error (location error, false positives, and false negatives), abundance and distribution data typically deal with only two: missed detections and false positives. Accounting for these errors is essential to avoid biased inference.<br><br>The second half of the session introduced hierarchical models as the statistical framework best suited to deal with these complexities. A hierarchical model is a sequence of random processes, where each submodel represents a biological or observation process. For example:<br></p><ul><li><p>Abundance model: \( N_j \sim \text{Poisson}(\lambda_j) \)<br></p></li><li><p>Observation model: \( y_{j,k} \sim \text{Binomial}(N_j, p_{j,k}) \)</p></li></ul><p>Alternatively, for presence/absence:</p><ul><li><p>State model: \( z_j \sim \text{Bernoulli}(\psi_j) \)<br></p></li><li><p>Observation model: \( y_{j,k} \sim \text{Bernoulli}(z_j \cdot p_{j,k}) \)</p></li></ul><p>These models can incorporate covariates and spatial effects using generalized linear model (GLM) formulations. For instance:<br></p><div>\[\log(\lambda_j) = \beta_0 + \beta_1 x_j + w_j,\]</div><p>where \( w_j \) is a spatial random effect.<br><br>The benefit of this structure is twofold: First, it separates the ecological signal from the observation noise; second, it allows for flexible and realistic modeling of complex datasets, across space, time, and species.<br><br>The takeaway message was clear: Hierarchical models are not just statistical tools, but conceptual frameworks that match the layered nature of ecological data. Whether we are modeling occupancy, abundance, detection, or their spatial and temporal patterns, hierarchical models allow us to describe the world more realistically and to account for the uncertainty that pervades all ecological observations.<br></p><h1 class="mb-4 text-lg-center mt-lg-4">Foundations & Core Spatial Concepts</h1><p>The first lecture of the occupancy modeling workshop, led by Jeffrey Doser, introduced the fundamental concepts behind species distribution models that account for imperfect detection. The problem is simple in theory but difficult in practice: when studying a species’ presence or absence across a landscape, how do we separate biological truth from observation error? This is particularly important in ecology, where even skilled observers may miss a species that is present, and absences may reflect limitations of detection rather than true absence.<br><br>To set the stage, the lecture began by discussing the kinds of questions ecologists often want to answer. These include understanding where species live, how effective conservation efforts have been, whether management changes influence entire communities, and how distributions shift over time. Each of these depends on having accurate knowledge of species occurrence, but our observations are always partial, noisy, and incomplete. Occupancy models were designed to deal with this reality.<br><br>We started by comparing different types of species data: presence-only data (where we know only where a species has been seen), presence-absence data (which also record when a species wasn’t observed), and count data (which record how many individuals were detected). The focus here was on presence-absence data collected through repeated surveys, what <a class="mb-lg-0 text-link-01" href="https://www.researchgate.net/publication/228821155_Estimating_Site_Occupancy_Rates_When_Detection_Probabilities_Are_Less_Than_One">MacKenzie et al. (2002)</a> call <i>detection/nondetection</i> data. For example, at a given site, a species might be seen during the first and last visit, but missed in between. This type of dataset allows us to start modeling both the probability that a species is present and the probability that it is detected.<br><br>Occupancy models work by separating the biological process: Whether the species actually occupies the site, from the observation process, whether it was detected. Each site has a latent (unobserved) occupancy state \( z_j \), which equals 1 if the species is present and 0 if absent. At the same time, each survey \( k \) at site \( j \) yields an observation \( y_{j,k} \), which is a function of both occupancy and detection. Even if the species is present, it may not be detected.<br><br>The model is built around two parts. First, the <i>occupancy model</i>, which describes the true (but unobserved) state of nature. We define the probability of occupancy at site \( j \) as \( \psi_j \), and model this as<br></p><div>\[z_j \sim \text{Bernoulli}(\psi_j)\]</div><p>Often, occupancy is influenced by site-level environmental variables—say, elevation, vegetation cover, or land use. These are included through a logistic regression:<br></p><div>\[\text{logit}(\psi_j) = \beta_0 + \beta_1 x_{1j} + \dots + \beta_R x_{Rj}\]</div><p>Second, the <i>observation model</i>, which accounts for the fact that a species may go undetected even if it is present. If the species is at the site, we model detection using<br></p><div>\[y_{j,k} \sim \text{Bernoulli}(p_{j,k}),\]</div><p>where \( p_{j,k} \) is the detection probability, possibly depending on covariates like weather, observer skill, or time of day:<br></p><div>\[\text{logit}(p_{j,k}) = \alpha_0 + \alpha_1 w_{1jk} + \dots + \alpha_Q w_{Qjk}\]</div><p>Together, these two components form a hierarchical model that allows us to estimate both presence and detectability. This is powerful because it lets us distinguish a true absence from a non-detection.<br><br>Of course, the model depends on some assumptions. Most importantly, the occupancy state must remain constant during the survey period: This is the <i>closure assumption</i>. The model also assumes no false positives (i.e. if the species is detected, it is truly there), that detections are independent across surveys, and that all relevant variation in detection is explained by covariates.<br><br>Bayesian models provide full posterior distributions, making uncertainty transparent and interpretable. They are more flexible and more naturally handle latent variables and hierarchical structures, especially when extending to spatial or multi-species models. In practice, Bayesian occupancy models are estimated using MCMC (Markov Chain Monte Carlo), which iteratively samples from the posterior distribution of each parameter.<br><br>We briefly discussed how this works in practice. After specifying priors for each parameter, the MCMC sampler proposes new values, accepts or rejects them based on likelihood, and repeats this process thousands of times. The resulting samples can be summarized using posterior means, medians, or credible intervals. Diagnostics like trace plots and R-hat values help assess convergence.<br><br>The hands-on component of the lecture used the <a class="text-link-01" href="https://doserlab.com/files/spoccupancy-web/">`spOccupancy`</a> R package, which simplifies fitting single-species, spatial, and multi-species occupancy models in a Bayesian framework. For this session, we worked with presence-absence data from the Swiss Breeding Bird Survey (MHB), focusing on the European goldfinch. Each site had multiple surveys, and the aim was to estimate occupancy across Switzerland while accounting for imperfect detection.<br></p><p class="mb-3">The next part of the workshop introduced spatial models. Many ecological datasets exhibit spatial autocorrelation, meaning that observations closer in space tend to be more similar than those further apart. If we ignore this dependence, we risk biased estimates and underestimated uncertainty. Spatial models incorporate coordinates directly into the analysis, allowing us to represent ecological processes that vary smoothly across the landscape.<br><br>The foundation is the spatial linear model. Suppose we observe a response \( y_i \) at each site \( i \). We model this as<br><br>\[y_i = \mathbf{x}_i^\top \beta + w_i + \epsilon_i,\]<br><br>where \( \mathbf{x}_i \) are covariates, \( \beta \) are regression coefficients, \( w_i \) is a spatial random effect, and \( \epsilon_i \) is independent error. The spatial random effect is modeled with a Gaussian process prior:<br><br>\[\mathbf{w} \sim \text{MVN}(0, \mathbf{C}),\]<br><br>where \(\mathbf{C}\) is a covariance matrix with entries determined by distances between sites. A common choice is the exponential covariance function,<br><br>\[\text{Cov}(w_i, w_j) = \sigma^2 \exp(-\phi d_{ij}),\]<br><br>where \( \sigma^2 \) is the variance, \( d_{ij} \) is the distance between sites \( i \) and \( j \), and \( \phi \) controls the rate at which correlation decays with distance. This structure allows nearby sites to share more information than distant ones.<br><br>Gaussian processes can be embedded in occupancy models by letting the occupancy probability at each site depend not only on covariates but also on a spatial random effect. This provides a flexible way to capture unmeasured spatial structure, such as habitat heterogeneity or dispersal processes. In practice, these models are fit using Bayesian methods, often implemented in packages like `spOccupancy`.<br><br>We explored how changing the parameters affects the spatial surface. Increasing \( \sigma^2 \) increases the overall variability in the spatial effect, while changing \( \phi \) alters the spatial scale of correlation. Small values of \( \phi \) yield long-range dependence, while large values yield short-range dependence. Visualizing these surfaces helps to understand what the model is capturing.<br><br>The key advantage of spatial models is that they reduce bias and improve inference by properly accounting for spatial dependence. However, this comes at a computational cost, since Gaussian process models require storing and inverting large covariance matrices.<br><br>The final part of the foundations addressed the computational challenges of fitting Gaussian process models when the number of locations becomes large. This is the so-called big-\( n \) problem. When we assign a Gaussian process prior to the spatial random effect, the covariance matrix \(\mathbf{C}\) is \( J \times J \), where \( J \) is the number of locations. For small \( J \), such as 5 or 10, inversion is trivial. But as \( J \) grows, the cost of storing and inverting \(\mathbf{C}\) scales as \( O(J^2) \) and \( O(J^3) \), respectively. For \( J = 1000 \), this already becomes infeasible, and with \( J = 1600 \), computation is prohibitively slow.<br><br>This difficulty arises because Gaussian processes require evaluating multivariate normal likelihoods, inverting dense matrices, and storing all pairwise distances. These demands quickly overwhelm both memory and processing time.<br><br>Several strategies have been developed to make Gaussian processes scalable:<br></p><ul><li><p><strong>Low-rank methods</strong> approximate the full covariance structure using a smaller set of basis functions, reducing the dimensionality of the spatial surface.</p></li><li><p><strong>Sparse methods</strong> impose sparsity in the covariance or precision matrix, drastically reducing computational requirements.</p></li><li><p><strong>Nearest Neighbor Gaussian Processes (NNGPs)</strong> approximate dependencies locally, conditioning each site only on a subset of its nearest neighbors. This retains much of the spatial structure while making computation feasible for thousands of sites.<br></p></li></ul><p>Among these, the lecture focused in detail on Nearest Neighbor Gaussian Processes (NNGPs), introduced by <a class="text-link-01" href="https://pubmed.ncbi.nlm.nih.gov/29720777/">Datta et al. (2016)</a> and further developed by <a class="text-link-01" href="https://pmc.ncbi.nlm.nih.gov/articles/PMC6753955/">Finley et al. (2019)</a>. NNGPs offer a sparse and scalable approximation to full GPs, while retaining the same model structure and interpretation. That is, NNGPs have the same spatial parameters as GPs and generate similar spatial surfaces, but can be applied to much larger datasets.<br><br>The conceptual foundation of NNGPs is surprisingly intuitive. First, spatial locations are ordered, often just along the x-axis. Then, for each location, we define a set of its \( m \) nearest neighbors (subject to the ordering). The key idea is that the spatial random effect at each location is assumed to depend only on the values of these neighbors. This assumption introduces <i>conditional independence</i>, which is the heart of what makes the approach computationally efficient.<br><br>Instead of a dense \( J \times J \) covariance matrix, NNGPs produce a sparse matrix. Each entry depends only on a small set of nearby locations. As a result, the storage requirement drops to \( O(Jm^2) \), and computation scales as \( O(Jm^3) \). Because \( m \ll J \), the savings are substantial. And unlike low-rank methods, NNGPs preserve local variation and perform well in capturing short-range spatial structure.<br><br>In practical terms, the `<a class="text-link-01" href="https://doserlab.com/files/spoccupancy-web/">spOccupancy</a>` and `<a class="text-link-01" href="https://doserlab.com/files/spabundance-web/">spAbundance</a>` R packages implement NNGPs by ordering sites along the Easting coordinate and using default neighbor sizes like \( m = 15 \). Users can adjust this value and compare different options using criteria like the Widely Applicable Information Criterion (WAIC). Even relatively small neighbor sets tend to perform well, and increasing \( m \) improves accuracy at the cost of computation.<br><br>We then looked at how NNGPs are built. Mathematically, they rely on rewriting the Gaussian process as a product of conditional densities. Graphical models are used to impose the neighbor structure, introducing sparsity in a principled way. At the end, the only change to the standard GP model is replacing the dense covariance matrix \( \mathbf{C} \) with a sparse NNGP-derived version. The rest of the modeling workflow, prior specification, likelihood structure, MCMC fitting, remains the same.<br><br>An example was presented with a simulated dataset of 1,600 locations. A full GP took significantly longer to fit, while the NNGP version completed in a fraction of the time with nearly identical results.<br></p><h1 class="mb-4 text-lg-center mt-lg-4">Spatial Occupancy & Survey Design</h1><p>The focus shifted to the implementation and interpretation of spatial occupancy models, specifically, how to fit and understand them using the `<a class="text-link-01" href="https://doserlab.com/files/spoccupancy-web/">spOccupancy</a>` package. While previous lectures laid out the theory behind spatial processes and modeling frameworks like Gaussian processes and their scalable approximations, this lecture applied those tools directly to the occupancy context.<br><br>The foundation remains the same: the basic occupancy model consists of two components. The ecological or occupancy sub-model defines the true presence or absence of a species at each site, while the detection sub-model accounts for imperfect observations. These are combined in a hierarchical Bayesian framework, allowing uncertainty to be modeled explicitly.<br><br>This time, the motivation was framed using a real-world example: The European goldfinch in Switzerland. The goal was to determine whether including spatial structure improves model performance and produces a more realistic species distribution map. The short answer is yes: spatial models provide more accurate predictions, more realistic estimates of uncertainty, and deeper insight into unmeasured ecological processes.<br><br>But why is residual spatial autocorrelation so common in species distributions? First, because ecological drivers like habitat suitability or environmental gradients often have spatial structure, and many of these drivers are unmeasured or unknown. Second, because species themselves interact with space, through dispersal, conspecific attraction, and biotic interactions. As a result, nearby locations tend to be more similar than distant ones, even after accounting for known covariates.<br><br>The spatial occupancy model reflects this reality by extending the standard occupancy formulation. In its spatial form, the occupancy probability \( \psi_j \) at site \( j \) is given by:<br></p><div>\[\text{logit}(\psi_j) = \mathbf{X}_j \boldsymbol{\beta} + w(s_j),\]</div><p>where \( \mathbf{X}_j \boldsymbol{\beta} \) is the usual linear predictor based on covariates and \( w(s_j) \) is a spatial random effect evaluated at location \( s_j \). This term captures residual spatial variation. Detection remains modeled in the same way, typically as:<br></p><div>\[\text{logit}(p_{j,k}) = \mathbf{W}_{j,k} \boldsymbol{\alpha}\]</div><p>Together, these define a full spatial occupancy model that can be fitted either with a full Gaussian process or with the more scalable NNGP approach.<br><br>The lecture then moved on to discuss prior distributions, especially for the regression coefficients \( \boldsymbol{\beta} \). In traditional generalized linear models, it is common to assign Normal priors like \( \text{Normal}(0, 1000) \). But this turns out to be highly informative in logistic models like occupancy, because coefficients live on the logit scale. A large prior variance leads to probabilities near 0 or 1, which can bias estimation. Instead, a more appropriate default is:<br></p><div>\[\boldsymbol{\beta} \sim \text{Normal}(0, 2.72)\]</div><p>This choice places more uniform weight on the probability scale and avoids the overconfidence induced by broader priors.<br><br>For the spatial parameters, the same structure introduced in Lecture 2 applies. The spatial decay parameter \( \phi \) governs how quickly spatial correlation drops with distance, and the spatial variance \( \sigma^2 \) controls the magnitude of the random effect. These parameters are often weakly identifiable, especially \( \phi \), and the lecture introduced the <i>adaptive Metropolis algorithm</i> used by `<a class="text-link-01" href="https://doserlab.com/files/spoccupancy-web/">spOccupancy</a>` to address this.<br><br>In contrast to a standard Metropolis algorithm, which uses a fixed proposal variance, the adaptive version adjusts the tuning variance throughout the MCMC run. This is done in batches, typically every 25 samples, and attempts to achieve a target acceptance rate of 0.43. Each batch provides feedback about how the chain is mixing, and the tuning variance is updated accordingly. This helps accelerate convergence, especially for parameters like \( \phi \), which are difficult to sample efficiently due to their strong influence on the shape of the spatial surface.<br><br>In practice, users of `<a class="text-link-01" href="https://doserlab.com/files/spoccupancy-web/">spOccupancy</a>` need to specify four key values when using the adaptive Metropolis implementation:<br></p><ol><li><p>`<i>tuning</i>`: The initial tuning variance.</p></li><li><p>`<i>accept.rate</i>`: The target acceptance rate.</p></li><li><p>`<i>n.batch</i>`: Number of MCMC batches.</p></li><li><p>`<i>batch.length</i>`: Number of MCMC samples per batch.</p></li></ol><p>The total number of MCMC samples is the product of `<i>n.batch</i>` and `<i>batch.length</i>`.<br></p><p>The classic framework for occupancy studies uses a grid of \( J \) sites, each visited \( K \) times. These repeated surveys allow estimation of both the occupancy probability \( \psi \) and the detection probability \( p \), which are confounded in single-visit datasets. The observed detection histories, such as \([1, 0, 0, 1]\), are used to infer whether a species is truly present but missed, or genuinely absent.<br><br>Choosing the right number of sites and visits is nontrivial. It depends on your goals. Do you want to estimate occupancy with a given precision? Compare two habitats? Detect a trend over time? Evaluate a new detection method? Or model population dynamics? The optimal survey effort looks different for each objective.<br><br>For basic estimation of occupancy, the main concern is the cumulative detection probability, defined as:<br></p><div>\[p^* = 1 - (1 - p)^K\]</div><p>This represents the probability of detecting the species at least once across \( K \) visits, given that it is present and detection probability per visit is \( p \). To design your survey, you can define the total number of surveys \( T = J \times K \), and then optimize the allocation between sites and visits.<br><br><a class="text-link-01" href="https://besjournals.onlinelibrary.wiley.com/doi/10.1111/j.1365-2664.2005.01098.x">MacKenzie & Royle (2005)</a> offer practical advice based on simulations. When detection is low (\( p \ll 0.5 \)), it is better to concentrate effort on fewer sites with more visits. When occupancy is low (\( \psi \ll 0.5 \)), the opposite holds: more sites with fewer visits yield more information. If detection is your main goal, prioritize repeated visits. If surveying new sites is costly, say, due to travel or access issues, it's again better to revisit fewer places.<br><br>In most cases, \( K \geq 3 \) is recommended to allow stable estimation of detection probabilities. When your study includes multiple species, it's often safest to design around the rarest or hardest-to-detect species. That design usually works for everything else.<br><br>The lecture then introduced alternative designs that deviate from the standard “\( J \) sites with \( K \) visits” format. The <i>removal design</i> stops visiting a site after the first detection. If a species is detected on the first visit, there's no need to return. This can save time and resources. It's particularly effective when occupancy is moderate to high (\( \psi \geq 0.4 \)). The removal design yields lower standard errors than the standard design under these conditions.<br><br>A second alternative is the <i>conditional design</i>, where every site is visited once, and only those with a detection are revisited. This approach was explored by Specht et al. (2017) and others. It is especially efficient for rare species with low detection probability, where many sites are likely to yield no detections at all. The first visit acts as a filter, identifying candidates for further effort.<br><br>A third hybrid is the <i>mixed design</i>, also known as “double sampling” or “fractional replication.” Here, a subset of sites receives only one visit (\( J_S \)), while another subset (\( J_R \)) is visited \( K \) times. This design can reduce field costs when some data is already available or when resources are limited. However, single-visit data only help if the species is very easy to detect. Otherwise, their contribution to parameter estimation is marginal. Still, when combined with repeated visits, even a few single-visit data points can slightly improve inference, particularly when occupancy and detection are modeled using continuous covariates.<br><br>The lecture then turned to dynamic objectives. Suppose you want to detect a change in occupancy over time. How much effort is needed to detect a decline of 50% with power \( = 0.8 \)? <a class="text-link-01" href="https://besjournals.onlinelibrary.wiley.com/doi/full/10.1111/j.2041-210X.2012.00225.x">Guillera-Arroita & Lahoz-Monfort (2012)</a> addressed this by simulating occupancy change scenarios. When both \( \psi \) and \( p \) are low, the required effort becomes huge. However, when detection is high, increasing the number of visits beyond two offers little additional power. When detection is low, increasing \( K \) yields strong gains in power.<br><br>Design must also take into account various sources of additional heterogeneity or error. For instance, variation in abundance, environmental covariates, observer skill, and species behavior can all affect detection. <a class="text-link-01" href="https://onlinelibrary.wiley.com/doi/abs/10.1111/j.1541-0420.2005.00439.x">Royle (2006)</a> modeled detection heterogeneity explicitly. False-positive detections introduce another layer of complexity, requiring models that distinguish between true and false observations. <a class="text-link-01" href="https://pubmed.ncbi.nlm.nih.gov/16676527/">Royle & Link (2006)</a> and <a class="text-link-01" href="https://esajournals.onlinelibrary.wiley.com/doi/10.1890/10-1396.1">Miller et al. (2011)</a> introduced frameworks for handling such errors.<br><br>Spatial autocorrelation, as discussed in earlier lectures, can bias parameter estimates if ignored. <a class="text-link-01" href="https://besjournals.onlinelibrary.wiley.com/doi/full/10.1111/2041-210X.12983">Guélat & Kéry (2018)</a> showed that ignoring spatial structure may result in false confidence in model predictions. Meanwhile, species availability also matters. A species may be present at a site but not detectable during the survey due to behavioral or life-history constraints. This is not a false negative: It’s a different process altogether, often tied to habitat use or seasonal activity.<br><br>So how should one choose the best design? It depends not just on the goal of the study, but also on the system being studied. Static systems might require estimation of a single occupancy value, while dynamic systems call for estimates of colonization, extinction, or trends over time. Sessile species like plants and amphibians differ from mobile species like birds. The spatial and temporal scale of interest also influences design decisions, as does the assumed closure period.<br><br>There are two main ways to select a suitable design. One is through simulation. By generating artificial data under plausible parameter values, fitting the intended model, and comparing the estimates, researchers can explore how bias, precision, or power behave under different survey setups. This method is accessible and forces researchers to understand their assumptions. It's especially helpful when sample sizes are small.<br><br>The other is through mathematical optimization, where analytic or numerical solutions are derived for design parameters that maximize power or minimize error. This approach is more elegant but less intuitive and often requires asymptotic assumptions or complex derivations.<br><br>The lecture ended with a simulation exercise, where students explored how the precision of estimated occupancy depends on the number of visits, occupancy probability, and detection probability. The results reinforced earlier messages: there is no one-size-fits-all design, but thoughtful choices can make a huge difference in study success.<br></p><h1 class="mb-4 text-lg-center mt-lg-4">Multi-species & Temporal Occupancy</h1><p>After building a solid understanding of single-species models, we moved into the realm of multi-species occupancy models (MSOMs), a powerful extension that leverages the structure of community data to improve inference, particularly for rare or hard-to-detect species. The statistical motivation is clear. Many of the species that conservationists are most interested in, <i>Species of Greatest Conservation Need</i>, are precisely those that are hardest to model due to low detection rates. When only a handful of detections exist across a landscape, single-species models tend to collapse under uncertainty. Multi-species models mitigate this by pooling information: not in a simplistic way, but by structuring the model hierarchically so that each species has its own parameters, but those parameters are drawn from a community-level distribution.<br><br>In MSOMs, the key structure looks similar to the standard occupancy model, just extended across species:<br></p><ul><li><p><i>The occupancy state</i> \( z_{i,j} \) describes whether species \( i \) occupies site \( j \).</p></li><li><p><i>The observation data</i> \( y_{i,j,k} \) record detections for species \( i \) at site \( j \) and replicate \( k \).</p></li><li><p><i>The occupancy probability</i> \( \psi_{i,j} \) and detection probability \( p_{i,j,k} \) are modeled using covariates, but their species-specific effects are treated as random effects drawn from a common community distribution.</p></li></ul><p>For instance, suppose we have a covariate \( x_j \) for each site. The model might specify:<br></p><div>\[\text{logit}(\psi_{i,j}) = \beta_{0,i} + \beta_{1,i} x_j\]</div><p>with<br></p><div>\[\beta_{0,i} \sim \text{Normal}(\mu_{\beta_0}, \sigma_{\beta_0}^2), \quad \beta_{1,i} \sim \text{Normal}(\mu_{\beta_1}, \sigma_{\beta_1}^2)\]</div><p>This hierarchical structure allows us to estimate both species-specific effects and the community-wide trends (i.e., the mean and variance of these effects across species). Importantly, species with fewer detections are shrunk toward the community mean, resulting in more stable estimates, especially useful when dealing with rare species.<br><br>There’s also a compelling ecological motivation. Historically, conservation efforts have focused on single species, but there is growing interest in understanding communities as wholes, especially in the face of biodiversity loss and habitat degradation. MSOMs provide a framework to assess community-wide responses to environmental gradients, spatial structure, and anthropogenic pressures, while still retaining species-specific inference.<br><br>The lecture introduced the `<a class="text-link-01" href="https://doserlab.com/files/spoccupancy-web/reference/mspgocc">msPGOcc()</a>` function in the `<a class="text-link-01" href="https://doserlab.com/files/spoccupancy-web/">spOccupancy</a>` package, which fits these models using Pólya-Gamma data augmentation. The required input is a three-dimensional array of detection-nondetection data: species \( \times \) site \( \times \) replicate. The arguments are nearly identical to the single-species function `<a class="text-link-01" href="https://doserlab.com/files/spoccupancy-web/reference/pgocc">PGOcc()</a>`, making it straightforward to extend existing analyses to a multi-species context.<br><br>One of the main strengths of MSOMs is the ability to derive community-level metrics. Because the model estimates site-by-species occupancy probabilities \( \psi_{i,j} \), we can compute species richness at each site simply by summing across species:<br></p><div>\[\text{Richness}_j = \sum_i \psi_{i,j}\]</div><p>These quantities aren’t model parameters, they’re derived quantities, made available through the full Bayesian framework. The same logic applies to metrics of diversity, beta-diversity, or composition. Inference is then available not only at the species level, but across entire communities.<br><br>However, MSOMs are not without downsides. They are slower to run than single-species models, and the need to format and handle multi-dimensional arrays can introduce complexity. While `<a class="text-link-01" href="https://doserlab.com/files/spoccupancy-web/">spOccupancy</a>` simplifies much of this, users still need to be careful when specifying species order, initial values, and priors. Another challenge is defining the community: Which species should be included? As <a class="text-link-01" href="https://onlinelibrary.wiley.com/doi/full/10.1002/ece3.976">Pacifici et al. (2014)</a> noted, community boundaries are often fuzzy, especially in mobile or transient systems.<br><br>One limitation of standard MSOMs is that they do not model residual species correlations. Each species is treated as conditionally independent, given the covariates and random effects. Yet in reality, species co-occur for reasons beyond shared environment: competition, facilitation, and unmeasured factors all contribute to residual associations.<br><br>To address this, the lecture introduced latent factor MSOMs, a hybrid approach that combines the strengths of MSOMs and Joint Species Distribution Models (JSDMs). The core idea is to represent unmeasured influences via latent factors: Hidden variables that account for residual correlations between species.<br><br>Instead of explicitly estimating a huge interspecies covariance matrix (which becomes intractable as the number of species grows), we reduce the dimensionality. Each species has a set of <i>factor loadings</i>, representing how strongly it responds to each latent factor. These loadings create a “signature” for each species. Species with similar signatures will tend to co-occur, even if the underlying cause isn’t directly observed.<br><br>This model is fitted in `<a class="text-link-01" href="https://doserlab.com/files/spoccupancy-web/">spOccupancy</a>` using the `<a class="text-link-01" href="https://doserlab.com/files/spoccupancy-web/reference/lfmspgocc">lfMsPGOcc()</a>` function. The user specifies the number of latent factors \( q \), and the model estimates both the latent factors and species-specific loadings. A common starting point is to use 5–10 latent factors, depending on the size of the community and the amount of variation expected.<br><br>The latent factor model provides a second set of derived quantities: The residual correlation matrix between species. This matrix reflects how species co-occur after accounting for known covariates. However, caution is needed in interpreting these correlations. They do not necessarily imply biological interactions. As emphasized in <a class="text-link-01" href="https://www.sciencedirect.com/book/9780128237687/applied-hierarchical-modeling-in-ecology-analysis-of-distribution-abundance-and-species-richness-in-r-and-bugs">Kéry and Royle (2021)</a>, residual correlation may reflect unmeasured covariates, sampling artifacts, or scale mismatches. Still, these matrices are useful for hypothesis generation and model-based ordination.<br><br>We concluded with a discussion of priors and constraints. Without restrictions, the factor loadings matrix is not identifiable. A common solution is to fix the diagonal of the loadings matrix to 1 and the upper triangle to 0. The remaining entries receive a \( \text{Normal}(0, 1) \) prior. This ensures model identifiability and interpretability. Ordering of species in the data becomes important: Especially for the first \( q \) species, whose loadings are fixed. Good practice includes placing common, well-detected species early in the list and reordering if convergence is poor.<br></p><p>We extended the multi-species framework introduced earlier by integrating spatial autocorrelation into community models. While single-species spatial occupancy models are already well-established, applying spatial structure across many species simultaneously brings unique challenges and benefits. Jeffrey Doser presented two distinct formulations of spatial MSOMs, highlighting their differences in power, scalability, and ecological interpretation.<br><br>The motivation for spatial MSOMs is straightforward. In community models, spatial autocorrelation becomes even more important than in single-species models. Different species respond to different environmental drivers, many of which are unmeasured or spatially structured. If these latent spatial processes are not explicitly modeled, parameter estimates may be biased and predictive performance degraded. Additionally, many species are rare, and their spatial patterns can only be recovered by leveraging spatial borrowing of strength.<br><br>The first approach introduced was the <i>Type 1 spatial MSOM</i>, which directly parallels the single-species spatial occupancy model. Here, each species receives its own spatial random effect \( w_i(s_j) \), modeled via a Nearest Neighbor Gaussian Process (NNGP). The occupancy probability for species \( i \) at site \( j \) is defined as:<br></p><div>\[\text{logit}(\psi_{i,j}) = \mathbf{X}_j \boldsymbol{\beta}_i + w_i(s_j)\]</div><p>This is essentially a stacked set of independent spatial occupancy models, one for each species, fitted simultaneously. The NNGP formulation ensures computational feasibility by approximating the full Gaussian process through sparse conditioning. However, estimating \( N \) spatial surfaces, one per species, quickly becomes burdensome when the number of species grows. The method is best suited to moderate datasets (e.g., fewer than 10 species and 100–500 locations), where each species has sufficient detections to estimate its own spatial field.<br><br>Type 1 spatial MSOMs retain all species-level parameters from the non-spatial version, and the detection model remains unchanged:<br></p><div>\[\text{logit}(p_{i,j,k}) = \mathbf{W}_{j,k} \boldsymbol{\alpha}_i\]</div><p>While intuitive and direct, this approach has practical limitations. First, computation becomes slow and memory-intensive for large communities. Second, rare species may not have enough data to reliably estimate a full spatial surface. As a result, this model is only used in select cases, especially when researchers are specifically interested in mapping spatial variation for a small number of well-detected species. <br><br>To overcome these limitations, the lecture introduced a more scalable and powerful method: <i>the spatial factor MSOM</i>.<br><br>This model builds on the latent factor MSOM introduced earlier, where residual species correlations are explained through a small number of latent variables. The key idea here is to allow these latent variables, called <i>spatial factors</i>, to vary smoothly across space. Each spatial factor \( f_q(s_j) \) is modeled as a spatial process (again using NNGPs for efficiency), and the species-specific spatial effects are reconstructed as weighted sums:<br></p><div>\[w_i(s_j) = \sum_{q=1}^{Q} \lambda_{i,q} f_q(s_j)\]</div><p>Here, \( \lambda_{i,q} \) are the species-specific loadings, and \( Q \) is the number of spatial factors, typically much smaller than the number of species. Instead of estimating \( N \) spatial surfaces, we estimate only \( Q \), and then use the loadings to derive species-specific spatial variation. The latent factors act as **missing covariates** that capture shared spatial structure across species.<br><br>The occupancy model now takes the form:<br></p><div>\[\text{logit}(\psi_{i,j}) = \mathbf{X}_j \boldsymbol{\beta}_i + \sum_{q=1}^{Q} \lambda_{i,q} f_q(s_j)\]</div><p>This spatial factor formulation is implemented in `<a class="text-link-01" href="https://doserlab.com/files/spoccupancy-web/">spOccupancy</a>` via the `<a class="text-link-01" href="https://doserlab.com/files/spoccupancy-web/reference/sfmspgocc">sfMsPGOcc()</a>` function. Just like in the non-spatial latent factor model, the user specifies the number of spatial factors, priors on the community-level parameters, and the restrictions required to ensure identifiability. Specifically, the factor loadings matrix \( \Lambda \) must be constrained, typically by fixing the upper triangle to zero and the diagonal to one for the first \( Q \) species.<br><br>This model handles spatial autocorrelation, species correlations, and imperfect detection in a unified framework. It scales to large communities, examples in the lecture included 2,619 sites and 98 species, and enables biodiversity metrics to be derived from posterior distributions. It is also more efficient than Type 1 spatial MSOMs, because far fewer spatial surfaces are estimated.<br><br>Moreover, the spatial factor MSOM facilitates <i>model-based ordination</i>, a way of visualizing community structure in reduced dimensions. Because species are represented by their loadings on latent spatial factors, the loadings define a low-dimensional embedding of ecological niches. This can be visualized using ordination plots, revealing patterns of niche partitioning, spatial association, or community clustering.<br><br>One important caveat, again, is interpretability. The latent spatial factors are not tied to any specific environmental gradient. They are emergent summaries of residual variation. While this does not reduce their inferential power, it does mean that causal interpretation must be cautious. Still, when combined with covariates, these models offer a rich view of species–environment relationships and spatial community structure.<br><br>The lecture concluded with a hands-on exercise using a simulated plant community, designed to illustrate niche partitioning along a spatial gradient. Participants explored how species loadings aligned with the spatial factors, and how the estimated occupancy surfaces varied across the landscape. This exercise reinforced the conceptual power of spatial factor MSOMs: Not just as tools for mapping presence or absence, but as models of ecological process and pattern.<br></p><p>The final layer of complexity in the occupancy modeling framework was the integration of time. While spatial models capture autocorrelation across landscapes, many ecological questions also involve dynamics across seasons or years. Multi-season models allow us to track how species distributions change over time and how occupancy patterns evolve due to colonization, extinction, or other temporal processes.<br><br>The goal of a multi-season occupancy model is to understand both spatial and temporal variation in species occurrence. For example, researchers might want to know how bat distributions in the western USA are shifting, whether occupancy is increasing or decreasing over time, or how environmental change is influencing range dynamics. Repeated surveys over multiple seasons provide the data needed to answer these questions.<br><br>From a statistical perspective, including multiple seasons improves our ability to estimate spatial random effects. More importantly, it allows us to model both the underlying ecological process and the observation process across time. The data structure follows a robust design: for each of \( J \) sites, data are collected over \( T \) seasons, and within each season \( t \), site \( j \) is visited \( K_{jt} \) times. This structure can accommodate missing data and unbalanced sampling efforts, where some sites are only visited in some years or with varying intensity.<br><br>Multi-season occupancy models assume closure within each season. That is, the occupancy state remains fixed for a given site during that year, but allow for changes between seasons. A site may be occupied in one year and unoccupied in the next, reflecting colonization or local extinction. This distinction underpins the conceptual difference between single- and multi-season models.<br><br>Three types of multi-season models were discussed.<br><br>First, the <i>dynamic occupancy model</i>, introduced by <a class="text-link-01" href="https://esajournals.onlinelibrary.wiley.com/doi/10.1890/02-3090">MacKenzie et al. (2003)</a>, explicitly models colonization and extinction between seasons. These models are more mechanistic, treating occupancy status as a Markov process that evolves through time:<br></p><div>\[\begin{aligned}z_{j,t} \mid z_{j,t-1} &\sim \text{Bernoulli}(\gamma_{j,t}) \quad \text{if } z_{j,t-1} = 0 \quad (\text{colonization}) \\z_{j,t} \mid z_{j,t-1} &\sim \text{Bernoulli}(1 - \epsilon_{j,t}) \quad \text{if } z_{j,t-1} = 1 \quad (\text{persistence})\end{aligned}\]</div><p>These models are conceptually rich but require more data to estimate transitions reliably, particularly when species are rare or detection is low.<br><br>Second, the <i>stacked occupancy model</i> simplifies things by treating each site-season combination as an independent unit. In this framework, the site-year is considered the “sampling unit,” and a standard single-season occupancy model is fitted across all combinations. This design sacrifices the mechanistic interpretation of colonization and extinction but is easier to fit and often more robust when data are sparse. Site-level random effects are used to account for repeated measures at the same location over time, reducing pseudoreplication:<br></p><div>\[\text{logit}(\psi_{j,t}) = \mathbf{X}_{j,t} \boldsymbol{\beta} + \alpha_j,\]</div><p>where \( \alpha_j \sim \text{Normal}(0, \sigma^2_\text{site}) \) is a site-level random effect. <br><br>Third, <i>spatio-temporal occupancy models</i> extend the stacked framework by including spatial and temporal random effects to capture autocorrelation across both dimensions. These models are especially useful for prediction and trend estimation, offering flexible structures that can accommodate nonlinear trends or autocorrelated processes.<br><br>Spatial effects are modeled using Gaussian processes or their scalable approximations. Temporal effects can be included in one of two ways:<br></p><ol><li><p><i>Unstructured temporal random effects</i>, which assign each year a separate intercept.</p></li><li><p><i>AR(1) processes</i>, where the temporal random effects follow an autoregressive structure:</p></li></ol><div>\[\eta_t \sim \text{Normal}(\rho \eta_{t-1}, \sigma^2_\text{time})\]</div><p>This formulation allows occupancy probability to vary smoothly over time, capturing temporal dependence in species dynamics.<br><br>In the `<a class="text-link-01" href="https://doserlab.com/files/spoccupancy-web/">spOccupancy</a>` package, different functions implement these models:<br></p><ul><li><p>`<a class="text-link-01" href="https://doserlab.com/files/spoccupancy-web/reference/tpgocc">tPGOcc()</a>` fits non-spatial multi-season models.</p></li><li><p>`<a class="text-link-01" href="https://doserlab.com/files/spoccupancy-web/reference/stpgocc">stPGOcc()</a>` includes both spatial and temporal random effects.</p></li><li><p>For multi-species versions, `<a class="text-link-01" href="https://doserlab.com/files/spoccupancy-web/reference/tmspgocc">tMsPGOcc()</a>` and `<a class="text-link-01" href="https://doserlab.com/files/spoccupancy-web/reference/stmspgocc">stMsPGOcc()</a>` are used.</p></li></ul><p>All multi-season models in `<a class="text-link-01" href="https://doserlab.com/files/spoccupancy-web/">spOccupancy</a>` rely on adaptive Metropolis-Hastings sampling. As in earlier spatial models, users must specify the number of MCMC batches and batch length. Temporal and spatial effects are modeled independently in these “separable” models, though recent developments in nonseparable models allow more complex interactions between time and space.<br><br>The lecture emphasized that spatial and temporal random effects are not just statistical adjustments. They represent latent ecological processes, unmeasured habitat variation, dispersal limitation, climate anomalies, that drive real species distributions. Properly accounting for these structures improves both inference and prediction.<br><br>One of the most exciting developments in this area is the ability to estimate spatially varying trends in occupancy. For example, we may want to know whether a species is declining in one region while increasing in another. This is possible by modeling interactions between spatial coordinates and time, or by allowing regression coefficients to vary across space:<br></p><div>\[\text{logit}(\psi_{j,t}) = \beta_0 + \beta_1(t) + f(s_j),\]</div><p>where \( \beta_1(t) \) may be time-varying, and \( f(s_j) \) is a spatial effect. These models can be used to generate maps of temporal change, showing where species are and where they are going.<br></p><p>We pushed the boundaries of spatial occupancy modeling by introducing spatially-varying coefficient (SVC) models. While previous approaches focused on modeling residual spatial autocorrelation, usually via a spatially-varying intercept, SVC models allow any coefficient in the model to vary smoothly across space. This is a powerful extension, especially for ecologists interested in understanding how species-environment relationships differ across geographic regions.<br><br>The central insight behind SVC models is simple: Species-environment relationships are often nonstationary. That is, the effect of a covariate on species occurrence may differ in different parts of the range. These variations can arise from many sources: Local climate, historical disturbance regimes, fine-scale habitat structure, soil characteristics, or species interactions. For example, a temperature gradient may have very different effects at the core of a species’ range versus its edges. These context-dependent responses are widespread in ecology and require models that allow for such flexibility.<br><br>Formally, spatially-varying species–environment relationships allow the slope coefficient itself to become a spatial surface. Consider a general occupancy model with one covariate \( x(s_j) \) at site \( s_j \). A standard model might define:<br></p><div>\[\text{logit}(\psi_j) = \beta_0 + \beta_1 x(s_j)\]</div><p>In an SVC model, this becomes:<br></p><div>\[\text{logit}(\psi_j) = \beta_0 + \left[\beta_1 + w_1(s_j)\right] x(s_j)\]</div><p>Here, \( w_1(s_j) \) is a spatial adjustment to the covariate coefficient, modeled using a Gaussian process. This term allows the strength—and even the direction—of the relationship between \( x \) and occupancy to change across the landscape.<br><br>To build toward this, the lecture reviewed five common approaches for modeling variation in species–environment relationships:<br></p><ol><li><p><i>Linear models</i>, where the covariate effect is fixed across space.</p></li><li><p><i>Quadratic models</i>, which introduce curvature (e.g., unimodal responses).</p></li><li><p><i>Stratum-specific models</i>, which assign different effects to discrete regions (e.g., habitat types), but only allow coarse-grained variation.</p></li><li><p><i>Interaction models</i>, where a covariate’s effect depends on another variable (e.g., temperature × vegetation type), but the interaction is still explicitly defined.</p></li><li><p><i>SVC models</i>, which treat the interaction variable as unknown and let the data determine how relationships vary over space.</p></li></ol><p>Among these, SVC models are the most flexible. They generalize the stratum model by allowing each site to have its own slope coefficient, with smoothing imposed by a spatial correlation structure. They also generalize the interaction model by letting the interaction structure emerge from the data, rather than being pre-specified.<br><br>The SVC model shares the same detection submodel as previous occupancy models, but the ecological submodel now includes multiple spatial processes: One for each spatially-varying coefficient (SVC), plus one for the spatially-varying intercept (SVI). Each of these random surfaces is modeled using a Nearest Neighbor Gaussian Process (NNGP), with its own spatial decay and variance parameters. This flexibility comes at a computational cost, but also enables much richer inference.<br><br>Implementation in `<a class="text-link-01" href="https://doserlab.com/files/spoccupancy-web/">spOccupancy</a>` is done using the `<a class="float-lg-none text-link-01" href="https://doserlab.com/files/spoccupancy-web/reference/svcpgocc">svcPGOcc()</a>` function for single-season models. Users specify which covariates should be treated as spatially varying. Each SVC can receive its own priors, and separate spatial parameters are estimated for each. Because these models are data hungry, it is recommended to use more informative priors on the spatial decay parameter \( \phi \), particularly to avoid fitting extremely small effective spatial ranges. For example, setting the upper bound of \( \phi \) based on the 25th percentile of intersite distances helps stabilize inference.<br><br>The lecture emphasized the practical uses of SVC models, especially for mapping spatial variation in species–environment relationships. Using the `<a class="text-link-01" href="https://rdrr.io/r/stats/predict.html">predict()</a>` function, one can generate maps of the spatially-varying coefficients. These maps show how the effect of a covariate changes across space, which can inform conservation decisions, identify ecological thresholds, or detect regions of species vulnerability.<br><br>Several extensions are supported:<br></p><ul><li><p>`<a class="float-lg-none text-link-01" href="https://doserlab.com/files/spoccupancy-web/reference/svcmspgocc">svcMsPGOcc()</a>` fits multi-species SVC occupancy models using a spatial factor approach.</p></li><li><p>`<a class="text-link-01" href="https://doserlab.com/files/spoccupancy-web/reference/svctpgocc">svcTPGOcc()</a>` fits multi-season SVC models for single species.</p></li><li><p>`<a class="text-link-01" href="https://doserlab.com/files/spoccupancy-web/reference/svcmspgocc">svcTMsPGOcc()</a>` fits multi-season, multi-species SVC models.</p></li></ul><p>But one shouldn’t assign spatial variation to every covariate by default. Spatially-varying coefficients (SVCs) should only be used when there is a clear ecological rationale suggesting that the effect of a covariate differs across space. It is good practice to compare SVC models to simpler, nested alternatives that are grounded in explicit hypotheses. A spatially-varying intercept should always be included to account for underlying spatial structure in the baseline. Once fitted, results should be visualized and interpreted in ecological context, with particular attention to the scale and direction of spatial variation.<br></p><h1 class="mb-4 text-lg-center mt-lg-4">Abundance Models</h1><p>We introduced a different but related modeling framework: spatial generalized linear mixed models (GLMMs) for abundance estimation. Unlike occupancy models, which only estimate presence or absence, GLMMs for abundance aim to model count data directly. This includes relative abundance models, where detection is not explicitly modeled, but where we still want to understand spatial and environmental drivers of population size.<br><br>There are good reasons to estimate abundance instead of, or in addition to, occupancy. Abundance patterns often reflect more fine-scale ecological processes. Abundance is also the foundation for conservation assessments, extinction risk evaluations, sustainable harvest estimates, and quantification of ecosystem services. Moreover, abundance can vary within areas where occupancy remains constant. Two populations may both be present, but one may be barely holding on while the other is thriving.<br><br>Absolute abundance is the total number of individuals in an area, but it is difficult to measure directly. Most ecological surveys do not meet the assumptions required for absolute abundance estimation, such as in distance sampling or capture-recapture. Instead, many studies rely on relative abundance: An index that is assumed to be proportional to true abundance. Relative abundance can be modeled using standard count data, provided that survey effort is standardized and detection biases are minimized or accounted for with covariates.<br><br>The most basic is the Poisson model, which assumes that the variance equals the mean. In practice, this is often too restrictive, so a Negative Binomial (NB) model is commonly used instead. It includes a dispersion parameter \( k \), where smaller values indicate more overdispersion. When \( k \to \infty \), the model converges to the Poisson.<br><br>For very large counts or continuous abundance data like biomass, Gaussian GLMMs may also be appropriate. In all of these models, abundance is modeled as a function of covariates with an appropriate link function, typically log or identity.<br></p><div>\[y_j \sim \text{Poisson}(\lambda_j), \quad \log(\lambda_j) = \mathbf{X}_j \boldsymbol{\beta} + \alpha_j\]</div><p>where \( y_j \) is the observed count at site \( j \), \( \mathbf{X}_j \) are site-level covariates, and \( \alpha_j \) is a random effect—possibly spatial.<br><br>Importantly, detection probability is not modeled separately in these GLMMs. This means that the resulting estimates reflect a mixture of detection and true abundance. If changes in detection are minimal across space, then relative abundance patterns primarily reflect real ecological variation. If detection varies strongly and unpredictably, however, the results can be misleading. For this reason, GLMMs for abundance should include covariates or random effects that capture variation in detection, such as observer ID or survey conditions.<br><br>The spatial extension of GLMMs follows the same principles discussed in earlier occupancy lectures. A spatially structured random effect is added to the model, modeled using a Nearest Neighbor Gaussian Process (NNGP):<br></p><div>\[\log(\lambda_j) = \mathbf{X}_j \boldsymbol{\beta} + w(s_j)\]</div><p>where \( w(s_j) \) is the spatial random effect at location \( s_j \), governed by an exponential covariance function with a spatial decay parameter \( \phi \) and variance \( \sigma^2 \). This allows for spatial smoothing and improved prediction at unsampled locations.<br><br>Models are fitted using the `<a class="text-link-01" href="https://doserlab.com/files/spabundance-web/">spAbundance</a>` package, which mirrors the syntax and structure of `<a class="text-link-01" href="https://doserlab.com/files/spoccupancy-web/">spOccupancy</a>`. However, the MCMC samplers used for GLMMs (e.g. Poisson and NB) are based on adaptive Metropolis-Hastings rather than Pólya-Gamma, which makes them less efficient and slower to converge. As a result, users often need to run longer chains: More samples and more batches to ensure convergence.<br><br>For a typical run, the user specifies:<br></p><ul><li><p>Number of MCMC batches</p></li><li><p>Batch length</p></li><li><p>Tuning variance</p></li><li><p>Target acceptance rate (usually 0.43)</p></li></ul><p>The sampler automatically adjusts the tuning variance during the run to maintain the desired acceptance rate. This is done every 25 iterations (one batch), and the process repeats across all batches. If the acceptance rate is too low, the tuning variance is increased; if too high, it is decreased.<br><br>Spatial GLMMs can be fitted using the `<a class="text-link-01" href="https://doserlab.com/files/spabundance-web/reference/spabund">spAbund()</a>` function. Non-spatial GLMMs use `<a class="text-link-01" href="https://doserlab.com/files/spabundance-web/reference/abund">abund()</a>`. The same framework supports different likelihoods: Poisson, NB, Gaussian, and zero-inflated Gaussian. The models are not limited to abundance, GLMMs can be applied to any response variable, making them versatile tools in applied ecology.<br><br>One key challenge in spatial GLMMs is the confounding between overdispersion and spatial autocorrelation. In a spatial NB GLMM, two components account for extra variance: the NB dispersion parameter \( k \) and the spatial random effect. If both try to explain the same variation, the model may fail to converge. To avoid this, informative priors should be placed on the spatial decay parameter \( \phi \). A recommended approach is to set the upper bound of the uniform prior on \( \phi \) to \( 3 / q_{0.15} \), where \( q_{0.15} \) is the 15th percentile of all pairwise site distances.<br><br>After single-species models, the lecture moved to multi-species abundance models, which are structured similarly to multi-species occupancy models. These GLMMs are sometimes called multivariate GLMMs or abundance-based Joint Species Distribution Models (JSDMs). As in MSOMs, each species’ regression coefficients are drawn from community-level distributions, allowing for borrowing of strength across the community. There are three main formulations:<br></p><ol><li><p>`<a class="text-link-01" href="https://doserlab.com/files/spabundance-web/reference/msabund">msAbund()</a>` – Multi-species model without residual species correlation. <br></p></li><li><p>`<a class="text-link-01" href="https://doserlab.com/files/spabundance-web/reference/lfmsabund">lfMsAbund()</a>` – Latent factor model that accounts for species correlation.</p></li><li><p>`<a class="text-link-01" href="https://doserlab.com/files/spabundance-web/reference/sfmsabund">sfMsAbund()</a>` – Spatial factor model that includes both spatial autocorrelation and species correlation.</p></li></ol><p>These models allow users to estimate relative abundance across communities, generate biodiversity metrics like richness and Shannon diversity, visualize community structure via ordination, and assess co-occurrence patterns. The lecture ended with two exercises: modeling relative abundance of the northern cardinal across North Carolina using a spatial GLMM, and estimating Shannon diversity across multiple sites with a spatial multi-species GLMM.<br></p><p>We returned to the topic of abundance, but this time under a very different framework. While GLMMs for count data model relative abundance, N-mixture models aim to estimate true latent abundance by explicitly accounting for imperfect detection. These models are an extension of occupancy models and rely on repeated count surveys: Using unmarked individuals to separate the detection process from the ecological process.<br><br>The premise is elegant: just as repeated detection/non-detection surveys allow us to estimate occupancy in the presence of imperfect detection, repeated counts at each site can be used to infer how many individuals were likely present, even if we missed some of them on each visit. This is the heart of the N-mixture model.<br><br>Let \( N_j \) be the latent abundance at site \( j \). During each visit \( k \), we record a count \( y_{j,k} \), which is assumed to follow a Binomial distribution:<br></p><div>\[y_{j,k} \sim \text{Binomial}(N_j, p)\]</div><p>Here, \( p \) is the detection probability, and the assumption is that \( N_j \) individuals were available for detection, but each had an independent probability \( p \) of being observed on that visit. The latent abundance \( N_j \) itself is modeled with a Poisson or Negative Binomial prior:<br></p><div>\[N_j \sim \text{Poisson}(\lambda_j)\]</div><p>with<br></p><div>\[\log(\lambda_j) = \mathbf{X}_j \boldsymbol{\beta}\]</div><p>This hierarchical structure allows us to estimate both the detection process and the true abundance distribution across sites.<br><br>However, N-mixture models come with strong assumptions:<br></p><ol><li><p>Closure within the sampling period (no births, deaths, immigration, or emigration between visits).</p></li><li><p>No false positives (all detections must be true individuals).</p></li><li><p>Independence of detections.</p></li><li><p>No individual heterogeneity in detection probability (every individual at a site has the same \( p \)).</p></li><li><p>Correct distributional assumptions (the Poisson or NB must represent the data-generating process).</p></li></ol><p>In practice, these assumptions are often violated or approximated, and the robustness of the model depends heavily on how closely reality follows these rules.<br><br>The implementation of N-mixture models in `<a class="text-link-01" href="https://doserlab.com/files/spabundance-web/">spAbundance</a>` is straightforward using the `NMix()` function. Users can choose Poisson or Negative Binomial distributions for \( N_j \). The model allows both random intercepts and slopes, though only as uncorrelated effects. Compared to occupancy models, convergence is slower and requires longer MCMC runs. This is because we are now estimating a latent integer variable for each site, making the parameter space larger and the likelihood more complex.<br><br>The lecture then introduced the spatial extension of N-mixture models. Just like in previous spatial occupancy and abundance models, we can add a spatially structured random effect to the model for \( \lambda_j \), using a Gaussian process (or NNGP) to capture spatial autocorrelation:<br></p><div>\[\log(\lambda_j) = \mathbf{X}_j \boldsymbol{\beta} + w(s_j)\]</div><p>Here, \( w(s_j) \) is the spatial random effect at site \( j \), modeled with an exponential decay function. Importantly, spatial autocorrelation is only added to the abundance part of the model (not the detection component).<br><br>One advantage of N-mixture models over occupancy models is that count data provide more information, which often leads to better estimation of the spatial surface. Compared to binary detection/non-detection data, counts are more informative, especially in estimating spatial covariance parameters like the decay rate \( \phi \) and variance \( \sigma^2 \). The result is that spatial random effects are often estimated with lower uncertainty in N-mixture models than in occupancy models with the same number of sites.<br><br>That said, the flexibility of N-mixture models comes with considerable challenges.<br><br>Posterior predictive checks (PPCs) are critical for evaluating model fit. The standard approach is to:<br></p><ol><li><p>Fit the model and draw replicate datasets from the posterior predictive distribution.</p></li><li><p>Optionally bin the data (e.g., total counts across visits or sites).</p></li><li><p>Compute fit statistics (e.g., mean, variance) for the observed and replicated datasets.</p></li><li><p>Compare the distributions (large discrepancies indicate lack of fit).</p></li></ol><p>In `<a class="text-link-01" href="https://doserlab.com/files/spabundance-web/">spAbundance</a>`, both conditional and marginal replicate datasets can be generated. Conditional replicates are based on the sampled values of \( N_j \), while marginal replicates involve simulating new \( N_j \) values from the prior. Marginal PPCs are generally more sensitive and should be preferred when checking overall model fit.<br><br>WAIC is available for model comparison using `<a class="text-link-01" href="https://doserlab.com/files/spabundance-web/reference/waicabund">waicAbund()</a>`, but it is computationally demanding due to the need to integrate over latent \( N_j \). Despite this, it provides a principled way to compare alternative models, such as Poisson versus NB, provided the chains have converged and the models fit the data well.<br><br>The most important section of the lecture was the discussion of difficulties with N-mixture models. While the theory is elegant, the practice can be treacherous. When assumptions are met and the data are not overly dispersed, spatial N-mixture models can yield reliable abundance estimates. But when overdispersion is present, especially in detection, the model can break down.<br><br>A central issue is identifiability. It is extremely difficult to distinguish between overdispersion in detection and overdispersion in abundance. <a class="text-link-01" href="https://besjournals.onlinelibrary.wiley.com/doi/full/10.1111/2041-210X.13062">Knape et al. (2018)</a> showed that a beta-binomial Poisson N-mixture model and a binomial NB N-mixture model are nearly indistinguishable. This means that the model may attribute detection noise to abundance variance, or vice versa: Leading to inflated and implausible estimates of abundance.<br><br>Moreover, when closure is violated, the model can severely overestimate true abundance. This happens frequently in mobile species, or when counts are affected by transient pulses of activity. <a class="text-link-01" href="https://www.sciencedirect.com/science/article/abs/pii/B9780123786050000016?via%3Dihub">Kéry (2010)</a> showed that estimates can easily become unreasonably high if closure fails and the model is forced to explain excessive variation.<br><br>As a result, spatial N-mixture models are arguably the most sensitive and difficult to fit among the models in `spAbundance`. They may require highly informative priors to converge. They are also prone to producing misleading results when used on overdispersed or messy data.<br><br>Several practical solutions were discussed. One is to use more informative priors on spatial or dispersion parameters to reduce identifiability issues. Another is to consider modeling relative abundance using spatial GLMMs instead, especially if the closure assumption is suspect. It is also important to run extensive posterior predictive checks and simulations to validate model behavior.<br><br>N-mixture models are powerful tools, but with that power comes responsibility. When used carefully, they offer a way to bridge the gap between detection-limited data and estimates of true ecological abundance. But when misused or blindly applied, they can lead to highly biased or even misleading conclusions.<br></p><p>We introduced the most complex model class presented so far: Spatial multi-species N-mixture models. These models extend the hierarchical abundance estimation framework to entire communities, integrating both species correlations and spatial structure while still accounting for imperfect detection. They represent the synthesis of nearly every idea discussed throughout the course: Latent abundance, repeated counts, spatial autocorrelation, and species community structure, woven into a single, high-dimensional model.<br><br>As with occupancy models, many surveys, particularly point counts and transect surveys, record data for multiple species. These community-level datasets can be analyzed using a hierarchical structure in which species-specific parameters are modeled as random effects drawn from shared distributions. This allows for borrowing strength across species, which is especially valuable for rare or poorly sampled species.<br><br>The basic setup mirrors the single-species N-mixture model. For each species \( i \), site \( j \), and visit \( k \), we model the observed count \( y_{i,j,k} \) as<br></p><div>\[y_{i,j,k} \sim \text{Binomial}(N_{i,j}, p_{i,j,k})\]</div><p>where \( N_{i,j} \) is the latent abundance of species \( i \) at site \( j \), and \( p_{i,j,k} \) is the detection probability on visit \( k \). The abundance itself is typically modeled using a Poisson or Negative Binomial distribution, i.e.:<br></p><div>\[N_{i,j} \sim \text{Poisson}(\lambda_{i,j}), \quad \log(\lambda_{i,j}) = \mathbf{X}_{j} \boldsymbol{\beta}_i\]</div><p>Species-level coefficients \( \boldsymbol{\beta}_i \) are then modeled hierarchically as random effects from a shared community-level distribution, allowing for community-level inference as well as species-specific results.<br><br>Three main formulations of multi-species N-mixture models were introduced, all implemented in the `<a class="text-link-01" href="https://doserlab.com/files/spabundance-web/">spAbundance</a>` package.<br></p><ol><li><p>Multi-species N-mixture models (`<a class="text-link-01" href="https://doserlab.com/files/spabundance-web/reference/msnmix">msNMix</a>`), model each species independently, but share species-level effects through a hierarchical prior. No residual correlations between species are included. These are the most stable and fastest to fit, and work well when interspecies correlations are weak or not of interest.</p></li><li><p>Latent factor multi-species N-mixture models (`<a class="text-link-01" href="https://doserlab.com/files/spabundance-web/reference/lfmsnmix">lfMsNMix</a>`), introduce a set of latent variables that capture residual species correlations. These latent factors are shared across species, and each species receives a loading vector that determines how it responds to each factor. This structure allows for co-occurrence modeling, ordination, and improved inference when species exhibit nonindependent structure.</p></li><li><p>Spatial factor multi-species N-mixture models (`<a class="text-link-01" href="https://doserlab.com/files/spabundance-web/reference/sfmsnmix">sfMsNMix</a>`) extend the latent factor model by adding spatial autocorrelation. Each latent factor is now modeled as a spatial process (typically using a Nearest Neighbor Gaussian Process (NNGP)), which allows both residual species correlation and spatial structure to be modeled simultaneously. This is the most powerful and flexible formulation, capable of handling complex communities with spatial structure and correlated responses.</p></li></ol><p>Notably, there is no non-factor spatial multi-species model in the package. This is because modeling separate spatial surfaces for each species, as done in `<a class="text-link-01" href="https://doserlab.com/files/spoccupancy-web/reference/stmspgocc">spMsPGOcc()</a>` for occupancy, becomes computationally infeasible for count data. The algorithms scale poorly with large count data due to heavier likelihood evaluation and slower mixing. Simulations in <a class="text-link-01" href="https://esajournals.onlinelibrary.wiley.com/doi/10.1002/ecy.4137">Doser et al. (2023)</a> showed that the spatial factor model performs comparably even when species correlations are absent, so it’s the preferred default.<br><br>As with other model classes, fitting these models comes with caveats. Posterior convergence can be slow, especially for overdispersed count data. Multi-species N-mixture models may require hundreds of thousands of MCMC iterations to reach convergence. They are also sensitive to initial values: A bad starting point can lead to poor mixing or convergence failure. To deal with this, the lecture recommended:<br></p><ul><li><p>First running the model for a short number of iterations to generate sensible initial values.</p></li><li><p>Then running the full model with multiple chains, using the saved initial values.</p></li><li><p>Using the terminal or script-based runs to parallelize chains and reduce computational burden.</p></li></ul><p>All the usual constraints and prior recommendations from earlier lectures apply here. Informative priors for the spatial decay parameter \( \phi \), careful ordering of species for latent factor models, and convergence diagnostics like trace plots and effective sample size are all critical.<br></p><p>Now we introduced hierarchical distance sampling, a method designed to estimate true abundance or density while explicitly accounting for imperfect detection. Unlike standard count-based GLMMs or N-mixture models that rely on repeated counts, distance sampling uses spatial information, specifically the distance between observer and detected individuals, to model detectability. This additional structure allows for stronger identification of abundance, even when detection rates are low or highly variable.<br><br>Distance sampling is widely used in field ecology. The core idea is that detection probability decreases with distance: an animal standing right next to the observer is almost always seen, while one at the edge of the detection zone is easily missed. By recording the distance to each detected individual, ecologists can build a detection function \( g(x) \) that models this relationship. A key assumption is that detection is perfect at zero distance, i.e., \( g(0) = 1 \), and that detection probability monotonically decreases with increasing distance.<br><br>Distance data can be collected as either continuous distances or binned into discrete intervals. In practice, most modeling, including all functions in `<a class="text-link-01" href="https://doserlab.com/files/spabundance-web/">spAbundance</a>`, uses binned data. This simplifies the likelihood and allows modeling via multinomial distributions. For example, a survey might record detections in bins such as 0–25 m, 25–50 m, and so on. Each bin records how many individuals were observed within that range. Binned distances can be derived from continuous measurements after data collection.<br><br>A key quantity in distance sampling is the detection probability \( p \), which is not constant but instead a function of both the detection function \( g(x) \) and the distribution of individuals with respect to the observer. In most applications, the latter is assumed to be uniform. For example, individuals are equally likely to occur at any distance from the transect line or point count center.<br><br>Two main detection functions are supported in `<a class="text-link-01" href="https://doserlab.com/files/spabundance-web/">spAbundance</a>`:<br></p><ol><li><p>The half-normal, where detection probability drops off smoothly and symmetrically around the observer.</p></li><li><p>The negative exponential, where detection decays rapidly with distance.</p></li></ol><p>Each function has a scale parameter \( \sigma \), which determines how quickly detection declines. Covariates can influence \( \sigma \), allowing detection probability to vary by time, observer, habitat, or weather. A typical detection function is parameterized as:<br></p><p>Finally we introduced the extension of hierarchical distance sampling (HDS) models from single species to multi-species frameworks. Many ecological surveys, such as transect counts or point counts, collect data simultaneously on multiple species. Just as with occupancy, GLMMs, and N-mixture models, the single-species HDS model can be generalized to account for community-level structure.<br><br>In multi-species distance sampling data, each observation is organized by species \( i = 1, 2, \ldots, I \), sites \( j = 1, 2, \ldots, J \), and distance bins \( k = 1, 2, \ldots, K \). For each site and species, the number of individuals detected within each distance interval is recorded. This structure allows the detection process to be modeled explicitly through detection functions, while abundance is estimated hierarchically.<br><br>Three main types of multi-species HDS models were presented, all available in the `<a class="text-link-01" href="https://doserlab.com/files/spabundance-web/">spAbundance</a>` package. The first are basic multi-species HDS models (msDS), where species are modeled hierarchically as random effects but no residual species correlations are included. The second are latent factor multi-species HDS models (lfMsDS), where species are modeled hierarchically and residual correlations are captured through latent factors. The third are spatial factor multi-species HDS models (sfMsDS), which extend the latent factor approach by adding spatial autocorrelation, allowing the model to capture both species correlations and spatial structure simultaneously.<br><br>The general structure of the models follows what has been seen earlier. For species \( i \) at site \( j \), the latent abundance \( N_{i,j} \) is modeled as<br></p><div>\[N_{i,j} \sim \text{Poisson}(\lambda_{i,j})\]</div><p class="mb-3">with a log-linear model for abundance,</p><div>\[\log(\lambda_{i,j}) = \mathbf{X}_j \boldsymbol{\beta}_i\]</div><p class="mb-3">where \( \mathbf{X}_j \) represents site-level covariates and \( \boldsymbol{\beta}_i \) are species-specific parameters. Observed counts in distance bins follow a multinomial distribution conditional on abundance and the detection function:<br></p><div>\[\mathbf{y}_{i,j} \sim \text{Multinomial}(N_{i,j}, \boldsymbol{\pi}_{i,j})\]</div><p class="mb-3">with \( \boldsymbol{\pi}_{i,j} \) representing the probabilities of detection in each distance bin. These probabilities are derived from a detection function \( g(x) \), such as the half-normal, which links the likelihood of detection to distance from the observer.<br><br>In the latent factor formulation, species-specific coefficients \( \boldsymbol{\beta}_i \) are not independent but linked through a lower-dimensional set of latent variables. Each species has loadings on these latent factors, enabling the model to capture shared ecological responses or unmeasured gradients. The spatial factor model builds on this by modeling each latent factor as a spatial process, allowing for residual spatial autocorrelation in abundance across sites.<br><br>The lecture concluded with an applied example estimating forest bird density in the northeastern United States using a spatial factor multi-species HDS model. Students worked through the process of loading multi-species count data, binning detections into distance intervals, specifying covariates, and fitting the model. The example highlighted how the models can recover both species-specific density estimates and community-level spatial patterns, offering insights into biodiversity across landscapes.<br><br>This session tied together the main themes of the workshop. By the end, it was clear that multi-species HDS models allow ecologists to move from single-species inference to full community-level analysis, incorporating detection, abundance, correlation, and spatial structure in one unified framework.<br></p></div></div></div></div><!-- bloc-85 END --><!-- ScrollToTop Button --><button aria-label="Scroll to top button" class="bloc-button btn btn-d scrollToTop" onclick="scrollToTarget('1',this)"><svg xmlns="http://www.w3.org/2000/svg" width="22" height="22" viewBox="0 0 32 32"><path class="scroll-to-top-btn-icon" d="M30,22.656l-14-13-14,13"/></svg></button><!-- ScrollToTop Button END--><!-- pencil-footer --><div class="bloc l-bloc" id="pencil-footer"><div class="container bloc-sm bloc-sm-lg"><div class="row"><div class="col-md-6 text-start order-1 order-md-0"><p class="mb-0 footer-brand">© Copyright - Gilles Colling</p></div><div class="col-md-6 text-start footer-right mb-md-0 mb-sm-3 mb-3"><a href="../contact/" class="a-btn text-link-01 p-md">Contact</a></div></div></div></div><!-- pencil-footer END --></div><!-- Main container END -->  <!-- Additional JS --><script src="../js/bootstrap.bundle.min.js?5838"></script><script src="../js/blocs.min.js?1800"></script><script src="../js/lazysizes.min.js" defer></script><!-- Additional JS END --><!-- KaTeX CSS --><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/KaTeX/0.16.4/katex.min.css"><!-- KaTeX JS --><script defer src="https://cdnjs.cloudflare.com/ajax/libs/KaTeX/0.16.4/katex.min.js"></script><!-- Auto-rendering --><script defer src="https://cdnjs.cloudflare.com/ajax/libs/KaTeX/0.16.4/contrib/auto-render.min.js"  onload="renderMathInElement(document.body);"></script></body></html>